parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function aa(a){return a&&a.__esModule?{d:a.default}:{d:a}}var pa={};const $d="*";const Xb=Symbol();const Yb=(e,t={})=>{const o=Reflect.ownKeys(e),r=Reflect.ownKeys(t),n=Symbol("isa");function i(t){for(let r of o){const o=Object.getOwnPropertyDescriptor(t.prototype,r);!o||o.configurable?Object.defineProperty(t.prototype,r,{value:e[r],writable:!0}):console.log(`not patching: ${t.name}.${r.toString()}`)}return Object.defineProperty(t.prototype,n,{value:!0}),t}for(let p of r)Object.defineProperty(i,p,{value:t[p],enumerable:t.propertyIsEnumerable(p)});return Object.defineProperty(i,Symbol.hasInstance,{value:e=>!!e[n]}),i};class Se extends Error{constructor(r){super("illegal argument(s)"+(void 0!==r?": "+r:""))}}const Wa=r=>{throw new Se(r)};class Ye extends Error{constructor(r){super(`illegal arity: ${r}`)}}const mc=r=>{throw new Ye(r)};class pf extends Error{constructor(t){super("illegal state"+(void 0!==t?": "+t:""))}}const vf=t=>{throw new pf(t)};const Bc=(e,t)=>{if(e)for(let i,r=0,s=e.length;r<s;r++)if((i=e[r])[0].call(i[1],t),t.canceled)return};const Jf=Yb({addListener(e,t,i){let r=(this._listeners=this._listeners||{})[e];return r||(r=this._listeners[e]=[]),-1===this.__listener(r,t,i)&&(r.push([t,i]),!0)},removeListener(e,t,i){if(!this._listeners)return!1;const r=this._listeners[e];if(r){const e=this.__listener(r,t,i);if(-1!==e)return r.splice(e,1),!0}return!1},notify(e){this._listeners&&(void 0===e.target&&(e.target=this),Bc(this._listeners[e.id],e),Bc(this._listeners[$d],e))},__listener(e,t,i){let r=e.length;for(;--r>=0;){const s=e[r];if(s[0]===t&&s[1]===i)break}return r}});const Rf=Yb({addWatch(t,e){return this._watches=this._watches||{},!this._watches[t]&&(this._watches[t]=e,!0)},removeWatch(t){if(this._watches)return!!this._watches[t]&&(delete this._watches[t],!0)},notifyWatches(t,e){if(!this._watches)return;const i=this._watches;for(let h in i)i[h](h,t,e)}});const fb=o=>"function"==typeof o;const Ab=(n,t)=>null!=n&&"function"==typeof n[t];const C=Array.isArray;const Lc=t=>null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator];const Kc=Object.getPrototypeOf,ig=$=>{let t;return null!=$&&"object"==typeof $&&(null===(t=Kc($))||null===Kc(t))};const hg=s=>s instanceof Promise;const V=t=>"string"==typeof t;const Jc=Array.isArray,_f=V,j=t=>Jc(t)?t.slice():Object.assign({},t),Uf=(t,$)=>(e,o)=>(e=j(e),e[t]=$?$(e[t],o):o,e),Pf=(t,$)=>e=>e?$(e[t]):void 0,bb=t=>Jc(t)?t:_f(t)?t.length>0?t.split("."):[]:null!=t?[t]:[];const sc=t=>{const $=bb(t);let[e,o,r,n]=$;switch($.length){case 0:return t=>t;case 1:return t=>t?t[e]:void 0;case 2:return t=>t&&(t=t[e])?t[o]:void 0;case 3:return t=>t&&(t=t[e])&&(t=t[o])?t[r]:void 0;case 4:return t=>t&&(t=t[e])&&(t=t[o])&&(t=t[r])?t[n]:void 0;default:const t=$[$.length-1];let s=$=>$?$[t]:void 0;for(let e=$.length-1;--e>=0;)s=Pf($[e],s);return s;}};const ab=t=>{const $=bb(t);let[e,o,r,n]=$;switch($.length){case 0:return(t,$)=>$;case 1:return(t,$)=>(t=j(t),t[e]=$,t);case 2:return(t,$)=>{let r;return(t=j(t))[e]=r=j(t[e]),r[o]=$,t};case 3:return(t,$)=>{let n,s;return(t=j(t))[e]=n=j(t[e]),n[o]=s=j(n[o]),s[r]=$,t};case 4:return(t,$)=>{let s,p,a;return(t=j(t))[e]=s=j(t[e]),s[o]=p=j(s[o]),p[r]=a=j(p[r]),a[n]=$,t};default:let t;for(let e=$.length;--e>=0;)t=Uf($[e],t);return t;}};const kc=(t,$,e)=>ab($)(t,e);const Ya=(t,$,e,...o)=>ab($)(t,e.apply(null,(o.unshift(sc($)(t)),o)));const ec=Object.getPrototypeOf({}),w=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==ec||null!=($=Object.getPrototypeOf(t))&&$!==ec?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?bc(e,t):e instanceof Set&&t instanceof Set?Wb(e,t):e instanceof Map&&t instanceof Map?Ob(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:Gb(e,t)))};const bc=(e,t,$=w)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const Wb=(e,t,$=w)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const Ob=(e,t,$=w)=>e.size===t.size&&$([...e].sort(),[...t].sort());const Gb=(e,t,$=w)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};let ge=0;const fe=()=>ge++;class de{constructor(t,i,s,e=!0,r=w){this.parent=t,this.id=`view-${fe()}`,this.tx=s||(t=>t),this.path=bb(i),this.isDirty=!0,this.isLazy=e;const h=sc(this.path),$=this.parent.deref();this.unprocessed=$?h($):void 0,e||(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),t.addWatch(this.id,(t,i,s)=>{const $=i?h(i):i,a=s?h(s):s;r(a,$)||(e?this.unprocessed=a:this.state=this.tx(a),this.isDirty=!0)})}get value(){return this.deref()}deref(){return this.isDirty&&(this.isLazy&&(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),this.isDirty=!1),this.state}changed(){return this.isDirty}view(){return this.isDirty&&this.isLazy?this.tx(this.unprocessed):this.state}release(){return this.unprocessed=void 0,this.isLazy||(this.state=this.tx(void 0)),this.isDirty=!0,this.parent.removeWatch(this.id)}}var Zd=pa&&pa.__decorate||function(e,t,r,i){var $,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)($=e[o])&&(s=(a<3?$(s):a>3?$(t,r,s):$(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s};let M=class{constructor(e,t){t&&!t(e)&&vf("initial state value did not validate"),this._value=e,this.valid=t}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){const t=this._value;return this.valid&&!this.valid(e)?t:(this._value=e,this.notifyWatches(t,e),e)}resetIn(e,t){return this.reset(kc(this._value,e,t))}swap(e,...t){return this.reset(e.apply(null,[this._value,...t]))}swapIn(e,t,...r){return this.reset(Ya(this._value,e,t,...r))}addWatch(e,t){return!1}removeWatch(e){return!1}notifyWatches(e,t){}addView(e,t,r=!0){return new de(this,e,t,r)}release(){return delete this._watches,delete this._value,!0}};M=Zd([Rf],M),pa.Atom=M,pa.Atom=M;let Ma,La;let Dd=[],Cd=[];const Ad=r=>Ma&&Ma.length>=r?Ma:Ma=new Int32Array(r),od=r=>La&&La.length>=r?La:La=new Int32Array(r),Hc=(r,$,e,a,t)=>{const c=$.length,l=r.linear;if(r.distance=c,0!==t){for(let r=0,e=0;r<c;r++,e+=3)l[e]=a,l[e+1]=r,l[e+2]=$[r];if(2===t){const a=r[e];for(let r=0;r<c;r++)a[r]=$[r]}}return r},Tc=(r,$,e=2,a=w)=>{const t={distance:0,adds:{},dels:{},const:{},linear:[]};if(r===$||null==r&&null==$)return t;if(null==r||0===r.length)return Hc(t,$,"adds",1,e);if(null==$||0===$.length)return Hc(t,r,"dels",-1,e);const c=r.length>=$.length;let l,n,h,s;c?(l=$,n=r):(l=r,n=$),h=l.length,s=n.length;const d=h+1,o=s-h,i=o+d,J=h+s+3,f=od(J).fill(-1,0,J),v=Ad(J).fill(-1,0,J),u=Dd,P=Cd;u.length=0,P.length=0;const g=(r,$,e)=>{const t=r+d;let c,o;$>e?(c=f[t-1],o=$):(c=f[t+1],o=e);let i=o-r;for(;i<h&&o<s&&a(l[i],n[o]);)i++,o++;return f[t]=P.length/3,P.push(i,o,c),o};let p,_,F=-1;do{for(_=(p=-++F)+d;p<o;p++,_++)v[_]=g(p,v[_-1]+1,v[_+1]);for(_=(p=o+F)+d;p>o;p--,_--)v[_]=g(p,v[_-1]+1,v[_+1]);v[i]=g(o,v[i-1]+1,v[i+1])}while(v[i]!==s);if(t.distance=o+2*F,0!==e){for(F=3*f[i];F>=0;)u.push(F),F=3*P[F+2];2===e?Dg(u,P,t,l,n,c):dg(u,P,t,l,n,c)}return t};const Dg=(r,$,e,a,t,c)=>{const l=e.linear,n=e.const;let h,s,d,o,i=r.length,J=0,f=0;for(c?(h=e.dels,s=e.adds,d=-1,o=1):(h=e.adds,s=e.dels,d=1,o=-1);--i>=0;){const e=r[i],c=$[e],v=$[e+1],u=v-c;for(;J<c||f<v;){const r=f-J;u>r?(l.push(d,f,h[f]=t[f]),f++):u<r?(l.push(o,J,s[J]=a[J]),J++):(l.push(0,J,n[J]=a[J]),J++,f++)}}},dg=(r,$,e,a,t,c)=>{const l=e.linear,n=c?-1:1,h=c?1:-1;let s=r.length,d=0,o=0;for(;--s>=0;){const e=r[s],c=$[e],i=$[e+1],J=i-c;for(;d<c||o<i;){const r=o-d;J>r?(l.push(n,o,t[o]),o++):J<r?(l.push(h,d,a[d]),d++):(l.push(0,d,a[d]),d++,o++)}}};const cg=(t,e,$=2,i=w)=>t===e?{distance:0}:0===$?$f(t,e,i):Sf(t,e,i);const $f=(t,e,$)=>{let i=0;for(let r in t){const f=e[r];(void 0===f||!$(t[r],f))&&i++}for(let r in e)!(r in t)&&i++;return{distance:i}},Sf=(t,e,$)=>{let i=0;const r=[],f=[],s=[];for(let n in t){const r=e[n];void 0===r?(f.push(n),i++):$(t[n],r)||(s.push(n,r),i++)}for(let n in e)n in t||(r.push(n),i++);return{distance:i,adds:r,dels:f,edits:s}};const ca=Array.isArray,Df=Math.max,dc=(()=>{const e=new Array(2048);for(let t=2,r=e.length;t<r;t++)e[t]=t-2;return e})(),tf=e=>{if(e<=dc.length)return dc.slice(0,e);const t=new Array(e);for(;--e>=2;)t[e]=e-2;return t},cc=(e,t,r,$,i,o=0)=>{const n=i[1];if(n.__skip)return;if(!1===n.__diff)return R($),void t.replaceChild(e,r,o,i);let a=n.__impl;if(a&&a!==t)return a.diffTree(e,a,r,$,i,o);const f=Tc($,i,1,U);if(0===f.distance)return;const s=f.linear,h=t.getChild(r,o);let T,l,p,K,Q,v,u,c;if(0!==s[0]||$[1].key!==n.key)return R($),void t.replaceChild(e,r,o,i);if((c=$.__release)&&c!==i.__release&&R($),0!==s[3]&&(of(t,h,$[1],i[1]),2===f.distance))return;const d=s.length,x=$.length-1,_=lf(s),g=tf(x+1);for(T=2,l=6;l<d;T++,l+=3)if(-1===(u=s[l])){if(c=s[l+2],ca(c)){if(void 0!==(Q=c[1].key)&&void 0!==_[Q][2])Q=(v=_[Q])[0],cc(e,t,h,$[Q],i[v[2]],g[Q]);else for(K=s[l+1],R(c),t.removeChild(h,g[K]),p=x;p>=K;p--)g[p]=Df(g[p]-1,0);}else"string"==typeof c&&t.setContent(h,"");}else if(1===u)if("string"==typeof(c=s[l+2]))t.setContent(h,c);else if(ca(c)&&(void 0===(Q=c[1].key)||void 0===_[Q][0]))for(K=s[l+1],t.createTree(e,h,c,g[K]),p=x;p>=K;p--)g[p]++;(c=i.__init)&&c!=$.__init&&c.apply(i,[h,...i.__args])};const of=(e,t,r,$)=>{const i=cg(r,$,2,w);e.removeAttribs(t,i.dels,r);let o,n,a,f=Xb;for(o=(a=i.edits).length;(o-=2)>=0;){const i=a[o];0===i.indexOf("on")&&e.removeAttribs(t,[i],r),"value"!==i?e.setAttrib(t,i,a[o+1],$):f=a[o+1]}for(o=(a=i.adds).length;--o>=0;)"value"!==(n=a[o])?e.setAttrib(t,n,$[n],$):f=$[n];f!==Xb&&e.setAttrib(t,"value",f,$)};const R=e=>{if(ca(e)){let t;if((t=e[1])&&!1===t.__release)return;for(e.__release&&(e.__release.apply(e.__this,e.__args),delete e.__release),t=e.length;--t>=2;)R(e[t])}};const lf=e=>{let t,r,$;const i={};for(let o=e.length;(o-=3)>=0;)r=e[o+2],ca(r)&&void 0!==(t=r[1].key)&&(!($=i[t])&&(i[t]=$=[,,]),$[e[o]+1]=e[o+1]);return i},Qb=Object.getPrototypeOf({}),U=(e,t)=>{let r;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=(r=Object.getPrototypeOf(e))&&r!==Qb||null!=(r=Object.getPrototypeOf(t))&&r!==Qb?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?bc(e,t,U):e instanceof Set&&t instanceof Set?Wb(e,t,U):e instanceof Map&&t instanceof Map?Ob(e,t,U):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:!(!1===e.__diff||!1===t.__diff)&&Gb(e,t,U)))};const Ue="http://www.w3.org/2000/svg";const Rd=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/;const Ld="animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view".split(" ").reduce((e,t)=>(e[t]=1,e),{});const Zh="area base br circle col command ellipse embed hr img input keygen line link meta param path polygon polyline rect source stop track use wbr ?xml".split(" ").reduce((e,t)=>(e[t]=1,e),{});const Hd={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&apos;"};const zd={button:1,option:1,text:1,textarea:1};const $h=new RegExp(`[${Object.keys(Hd)}]`,"g");const rd=t=>{let $,r="";for(let e in t)$=t[e],fb($)&&($=$(t)),null!=$&&(r+=`${e}:${$};`);return r};const ad=(e,t)=>{if(null==e||!t||!t.length)return e;const r=Object.assign({},e);for(let n of t){const e=r[n];Ab(e,"deref")&&(r[n]=e.deref())}return r};const va=C,lb=Lc,xa=(e,t,r,s,n)=>{if(va(s)){const $=s[0];if("function"==typeof $)return xa(e,t,r,$.apply(null,[e.ctx,...s.slice(1)]),n);const o=s[1];if(o.__impl)return o.__impl.createTree(e,r,s,n);const i=t.createElement(r,$,o,n);if(s.length>2){const r=s.length;for(let n=2;n<r;n++)xa(e,t,i,s[n])}return s.__init&&s.__init.apply(s.__this,[i,...s.__args]),i}if(lb(s)){const n=[];for(let $ of s)n.push(xa(e,t,r,$));return n}return null==s?r:t.createTextElement(r,s)};const ya=(e,t,r,s,n=0)=>{if(va(s)){const $=t.getChild(r,n);"function"==typeof s[0]&&ya(e,t,r,s[0].apply(null,[e.ctx,...s.slice(1)]),n);const o=s[1];if(o.__impl)return o.__impl.hydrateTree(e,r,s,n);s.__init&&s.__init.apply(s.__this,[$,...s.__args]);for(let e in o)0===e.indexOf("on")&&t.setAttrib($,e,o[e]);for(let r=s.length,n=2;n<r;n++)ya(e,t,$,s[n],n-2)}else if(lb(s))for(let $ of s)ya(e,t,r,$,n),n++};const ze=(e,t,r,s)=>{const n=Ld[t]?document.createElementNS(Ue,t):document.createElement(t);return e&&(null==s?e.appendChild(n):e.insertBefore(n,e.children[s])),r&&$c(n,r),n};const Rc=(e,t,r)=>{const s=document.createTextNode(t);return e&&(void 0===r?e.appendChild(s):e.insertBefore(s,e.children[r])),s};const me=(e,t)=>e.children[t];const We=(e,t,r,s,n)=>(t.removeChild(r,s),t.createTree(e,r,n,s));const xg=(e,t)=>e.textContent=t;const $c=(e,t)=>{for(let r in t)Jb(e,r,t[r],t);return e};const Jb=(e,t,r,s)=>{if(t.startsWith("__"))return;const n=0===t.indexOf("on");if(n||"function"!=typeof r||(r=r(s)),void 0!==r&&!1!==r)switch(t){case"style":qd(e,r);break;case"value":hd(e,r);break;case"id":case"checked":case"scrollTop":case"scrollLeft":e[t]=r;break;default:n?td(e,t.substr(2),r):e.setAttribute(t,r);}else null!=e[t]?e[t]=null:e.removeAttribute(t);return e};const hd=(e,t)=>{let r;switch(e.type){case"text":case"textarea":case"password":case"search":case"number":case"email":case"url":case"tel":case"date":case"datetime-local":case"time":case"week":case"month":if(void 0!==(r=e.value)&&"string"==typeof t){const s=t.length-(r.length-e.selectionStart);e.value=t,e.selectionStart=e.selectionEnd=s;break}default:e.value=t;}};const jd=(e,t,r)=>{for(let s=t.length;--s>=0;){const n=t[s];0===n.indexOf("on")?Kd(e,n.substr(2),r[n]):e[n]?e[n]=null:e.removeAttribute(n)}};const qd=(e,t)=>(e.setAttribute("style",rd(t)),e);const td=(e,t,r)=>{va(r)?e.addEventListener(t,...r):e.addEventListener(t,r)};const Kd=(e,t,r)=>{va(r)?e.removeEventListener(t,...r):e.removeEventListener(t,r)};const Td=(e,t)=>{const r=e.children[t];void 0!==r&&e.removeChild(r)};const za=C,Ae=Lc,Qe=ig,Te=(e,r)=>{let $,i,t,n,a=e[0],o=Qe(e[1]);return"string"==typeof a&&($=Rd.exec(a))||Wa(`${a} is not a valid tag name`),a!==$[1]||!o||r&&!e[1].key?(n=o?Object.assign({},e[1]):{},i=$[2],t=$[3],i&&(n.id=i),t&&(t=t.replace(/\./g," "),n.class?n.class+=" "+t:n.class=t),n.__skip&&e.length<3?[$[1],n,""]:[$[1],n,...e.slice(o?2:1)]):e};const Ve=(e,r)=>v(r,e,e.ctx,[0],!1!==e.keys,!1!==e.span);const v=(e,r,$,i,t,n)=>{if(null!=e){if(za(e)){if(0===e.length)return;let a,o,l=e[1];if(l&&(o=l.__impl)&&(o=o.normalizeTree))return o(r,e);const s=e[0];if("function"==typeof s)return v(s.apply(null,[$,...e.slice(1)]),r,$,i,t,n);if("function"==typeof s.render){const o=[$,...e.slice(1)];return a=v(s.render.apply(s,o),r,$,i,t,n),za(a)&&(a.__this=s,a.__init=s.init,a.__release=s.release,a.__args=o),a}if(!1===(l=(a=Te(e,t))[1]).__normalize)return a;if(t&&void 0===l.key&&(l.key=i.join("-")),a.length>2){const e=a[0],o=[e,l];n=n&&!zd[e];for(let l=2,s=2,x=0,c=a.length;l<c;l++){let e=a[l];if(null!=e){const a=za(e);if(a&&za(e[0])||!a&&Ae(e))for(let l of e)void 0!==(l=v(l,r,$,i.concat(x),t,n))&&(o[s++]=l),x++;else void 0!==(e=v(e,r,$,i.concat(x),t,n))&&(o[s++]=e),x++}}return o}return a}return"function"==typeof e?v(e($),r,$,i,t,n):"function"==typeof e.toHiccup?v(e.toHiccup(r.ctx),r,$,i,t,n):"function"==typeof e.deref?v(e.deref(),r,$,i,t,n):n?["span",t?{key:i.join("-")}:{},e.toString()]:e.toString()}};const _e={createTree(e,t,r,$){return xa(e,this,t,r,$)},hydrateTree(e,t,r,$){return ya(e,this,t,r,$)},diffTree(e,t,r,$,i){cc(e,this,t,r,$,i)},normalizeTree:Ve,getElementById:e=>document.getElementById(e),getChild:me,createElement:ze,createTextElement:Rc,replaceChild(e,t,r,$){We(e,this,t,r,$)},removeChild:Td,setContent:xg,removeAttribs:jd,setAttrib:Jb};const ef=(e,o)=>V(e)?o.getElementById(e):e;const jf=(e,r={},t=_e)=>{const a=Object.assign({root:"app"},r);let $=[],o=!0;const i=ef(a.root,t),f=()=>{if(o){a.ctx=ad(r.ctx,a.autoDerefKeys);const s=t.normalizeTree(a,e);null!=s&&(a.hydrate?(t.hydrateTree(a,i,s),a.hydrate=!1):t.diffTree(a,i,$,s),$=s),o&&requestAnimationFrame(f)}};return requestAnimationFrame(f),()=>o=!1};const qf="--set-value";const rf="--update-value";const zf="--toggle-value";const Cf="--cancel";const Hf="--dispatch";const If="--dispatch-async";const Vf="--dispatch-now";const jg="--delay";const kg="--fetch";const rb="--state";const Sc="--redo";const Yc="--undo";const Sa=Cf,Kb=Vf,n=rb;class bd{constructor(t,e){this.handlers={},this.effects={},this.eventQueue=[],this.priorities=[],this.addBuiltIns(),t&&this.addHandlers(t),e&&this.addEffects(e)}addBuiltIns(){this.addEffects({[Hf]:[t=>this.dispatch(t),-999],[If]:[([t,e,r,s])=>{const i=this.effects[t];if(i){const t=i(e,this);hg(t)?t.then(t=>this.dispatch([r,t])).catch(t=>this.dispatch([s,t])):console.warn("async effect did not return Promise")}else console.warn(`skipping invalid async effect: ${t}`)},-999],[jg]:[([t,e])=>new Promise(r=>setTimeout(()=>r(e),t)),1e3],[kg]:[t=>fetch(t).then(t=>{if(!t.ok)throw new Error(t.statusText);return t}),1e3]})}addHandler(t,e){const r=C(e)?e.map(Rb):fb(e)?[{pre:e}]:[e];r.length>0?(this.handlers[t]&&(this.removeHandler(t),console.warn(`overriding handler for ID: ${t}`)),this.handlers[t]=r):Wa(`no handlers in spec for ID: ${t}`)}addHandlers(t){for(let e in t)this.addHandler(e,t[e])}addEffect(t,e,r=1){this.effects[t]&&(this.removeEffect(t),console.warn(`overriding effect for ID: ${t}`)),this.effects[t]=e;const s=[t,r],i=this.priorities;for(let $=0;$<i.length;$++)if(s[1]<i[$][1])return void i.splice($,0,s);i.push(s)}addEffects(t){for(let e in t){const r=t[e];C(r)?this.addEffect(e,r[0],r[1]):this.addEffect(e,r)}}instrumentWith(t,e){const r=t.map(Rb),s=this.handlers;for(let i of e||Object.keys(s)){const t=s[i];t&&(s[i]=r.concat(t))}}removeHandler(t){delete this.handlers[t]}removeHandlers(t){for(let e of t)this.removeHandler(e)}removeEffect(t){delete this.effects[t];const e=this.priorities;for(let r=e.length-1;r>=0;r--)if(t===e[r][0])return void e.splice(r,1)}removeEffects(t){for(let e of t)this.removeEffect(e)}context(){return this.currCtx}dispatch(...t){this.eventQueue.push(...t)}dispatchNow(...t){(this.currQueue||this.eventQueue).push(...t)}dispatchLater(t,e=17){setTimeout(()=>this.dispatch(t),e)}processQueue(t){if(this.eventQueue.length>0){this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=t||{};for(let e of this.currQueue)this.processEvent(t,e);return this.currQueue=this.currCtx=void 0,this.processEffects(t),!0}return!1}processEvent(t,e){const r=this.handlers[e[0]];if(!r)return void console.warn(`missing handler for event type: ${e[0].toString()}`);const s=r.length-1;let i=!1;for(let $=0;$<=s&&!t[Sa];$++){const s=r[$];s.pre&&this.mergeEffects(t,s.pre(t[n],e,this,t)),i=i||!!s.post}if(i)for(let $=s;$>=0&&!t[Sa];$--){const s=r[$];s.post&&this.mergeEffects(t,s.post(t[n],e,this,t))}}processEffects(t){const e=this.effects;for(let r of this.priorities){const s=r[0],i=t[s];if(void 0!==i){const r=e[s];if(s!==n)for(let e of i)r(e,this,t);else r(i,this,t)}}}mergeEffects(t,e){if(e)for(let r in e){const s=e[r];if(null!=s)if(r===n||r===Sa)t[r]=s;else if(r===Kb){if(C(s[0]))for(let t of s)t&&this.dispatchNow(t);else this.dispatchNow(s);}else if(t[r]||(t[r]=[]),C(s[0]))for(let e of s)void 0!==e&&t[r].push(e);else t[r].push(s)}}}class cd extends bd{constructor(t,e,r){super(e,r),this.state=t||new M({})}deref(){return this.state.deref()}addBuiltIns(){super.addBuiltIns(),this.addHandlers({[qf]:(t,[e,[r,s]])=>({[n]:kc(t,r,s)}),[rf]:(t,[e,[r,s,...i]])=>({[n]:Ya(t,r,s,...i)}),[zf]:(t,[e,r])=>({[n]:Ya(t,r,t=>!t)}),[Yc]:fc("undo"),[Sc]:fc("redo")}),this.addEffects({[n]:[t=>this.state.reset(t),-1e3]})}processQueue(t){if(this.eventQueue.length>0){const e=this.state.deref();this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=Object.assign({},t,{[n]:e});for(let r of this.currQueue)this.processEvent(t,r);return this.currQueue=this.currCtx=void 0,this.processEffects(t),this.state.deref()!==e}return!1}}const Rb=t=>fb(t)?{pre:t}:t,fc=t=>(e,[r,s],i,$)=>{let o=s?s[0]:"history";if(Ab($[o],t)){const e=$[o][t]();return{[n]:i.state.deref(),[Kb]:s?void 0!==e?s[1]:s[2]:void 0}}console.warn("no history in context")};const jc=(e,$)=>{const t=ab(e);return(e,[r,o])=>({[rb]:t(e,$?$(o):o)})};const W="route-changed";var sa={};var xd=sa&&sa.__decorate||function(t,e,r,i){var o,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var n=t.length-1;n>=0;n--)(o=t[n])&&(s=(a<3?o(s):a>3?o(e,r,s):o(e,r))||s);return a>3&&s&&Object.defineProperty(e,r,s),s};let ra=class{constructor(t){t.authenticator=t.authenticator||((t,e,r)=>({id:t.id,title:t.title,params:r})),t.prefix=void 0===t.prefix?"/":t.prefix,t.separator=t.separator||"/",this.config=t}addListener(t,e,r){return!1}removeListener(t,e,r){return!1}notify(t){}start(){if(this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.current={id:t.id,title:t.title,params:{}},this.notify({id:W,value:this.current})}}route(t){"#"===t.charAt(0)&&(t=t.substr(1)),t=t.substr(this.config.prefix.length);const e=this.config.routes,r=t.split(this.config.separator);let i;for(let o=0,a=e.length;o<a;o++){const t=e[o],a=this.matchRoute(r,t);if(a){i=a;break}}if(!i){if(!this.handleRouteFailure())return;const t=this.routeForID(this.config.defaultRouteID);i={id:t.id,title:t.title,params:{}}}return w(i,this.current)||(this.current=i,this.notify({id:W,value:i})),i}format(...t){let e,[r,i,o]=t;switch(t.length){case 3:e={id:r,params:i};break;case 2:V(r)?e={id:r,params:i}:(o=i,e=r);break;case 1:e=V(r)?{id:r}:r;break;default:mc(t.length);}const a=this.routeForID(e.id);if(a){const t=e.params||{};return(o?"#":"")+this.config.prefix+a.match.map(e=>"?"===e.charAt(0)?null!=(e=t[e.substr(1)])?e:"NULL":e).join(this.config.separator)}Wa(`invalid route ID: ${e.id.toString()}`)}routeForID(t){return this.config.routes.find(e=>e.id===t)}matchRoute(t,e){const r=e.match,i=r.length;if(t.length===i){const o={};for(let e=0;e<i;e++){const i=r[e];if("?"===i.charAt(0))o[i.substr(1)]=t[e];else if(t[e]!==i)return}if(e.validate&&!this.validateRouteParams(o,e.validate))return;return e.auth?this.config.authenticator(e,t,o):{id:e.id,title:e.title,params:o}}}validateRouteParams(t,e){for(let r in e)if(void 0!==t[r]){const i=e[r];if(i.coerce&&(t[r]=i.coerce(t[r])),i.check&&!i.check(t[r]))return!1}return!0}handleRouteFailure(){return!0}};ra=xd([Jf],ra),sa.BasicRouter=ra,sa.BasicRouter=ra;class Fd extends ra{constructor(t){super(t),this.useFragment=!1!==t.useFragment}start(){if(window.addEventListener("popstate",this.handlePopChange()),this.useFragment&&window.addEventListener("hashchange",this.handleHashChange()),this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.route(this.format({id:t.id,title:t.title}))}else this.route(this.useFragment?location.hash:location.pathname)}release(){window.removeEventListener("popstate",this.popHandler),this.useFragment&&window.removeEventListener("hashchange",this.hashHandler)}route(t,e=!0){const r=this.current,i=super.route(t);return w(i,r)||(this.currentPath=this.format(i),e&&history.pushState(this.currentPath,i.title||window.document.title||"",this.currentPath)),i}routeTo(t){this.useFragment&&(location.hash=t),this.route(t)}format(...t){let e;switch(t.length){case 2:e={id:t[0],params:t[1]};break;case 1:e=V(t[0])?{id:t[0]}:t[0];break;default:mc(t.length);}return super.format(e,this.useFragment)}handlePopChange(){return this.popHandler=this.popHandler||(t=>{this.route(t.state||(this.useFragment?location.hash:location.pathname),!1)}).bind(this)}handleHashChange(){return this.hashHandler=this.hashHandler||(t=>{if(!this.ignoreHashChange){const e=t.newURL.substr(t.newURL.indexOf("#"));e!==this.currentPath&&this.route(e,!1)}}).bind(this)}handleRouteFailure(){return this.ignoreHashChange=!0,location.hash=this.format({id:this.routeForID(this.config.defaultRouteID).id}),this.ignoreHashChange=!1,!0}}var qa={};qa.JSON="load-json";qa.ROUTE_TO="route-to";var H={};H.ROUTE_TO="route-to";H.BG_ACTIVE="bg-active";function Jd(s,{init:e,update:$,release:r}){let a;return Yd({init($,r,t){var $Atir$$interop$default=aa(Sd);g.addExtensionsToContext(r),(a=$Atir$$interop$default.d($))(),s.init(r),e&&e($,r)},update(e,r,a,t,n,i,o){s.params=o,s.render(t,n),$&&$(e,r)},release(s,e,$){r&&r(s,e)}})}var Da,g={};!function(e,r){if("object"==typeof g)g=r();else if("function"==typeof Da&&Da.amd)Da([],r);else if("object"==typeof g){var t=r();g.twgl=t}else e.twgl=r()}("undefined"!=typeof self?self:g,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s="./src/twgl-full.js")}({"./src/attributes.js":function(e,r,t){r.__esModule=!0,r.createAttribsFromArrays=v,r.createBuffersFromArrays=function(e,r){var t={};Object.keys(r).forEach(function(n){t[n]=E(e,r[n],n)}),r.indices?(t.numElements=r.indices.length,t.elementType=n.getGLTypeForTypedArray(d(r.indices),"indices")):t.numElements=function(e){var r,t;for(t=0;t<b.length&&!((r=b[t])in e);++t);t===b.length&&(r=Object.keys(e)[0]);var n=e[r],a=c(n).length,o=y(n,r),i=a/o;if(a%o>0)throw"numComponents "+o+" not correct for length "+a;return i}(r);return t},r.createBufferFromArray=E,r.createBufferFromTypedArray=f,r.createBufferInfoFromArrays=function(e,r,t){var a=v(e,r),o=Object.assign({},t||{});o.attribs=Object.assign({},t?t.attribs:{},a);var u=r.indices;if(u){var s=d(u,"indices");o.indices=f(e,s,e.ELEMENT_ARRAY_BUFFER),o.numElements=s.length,o.elementType=n.getGLTypeForTypedArray(s)}else o.numElements||(o.numElements=function(e,r){var t,n;for(n=0;n<b.length&&!((t=b[n])in r)&&!((t=i.attribPrefix+t)in r);++n);n===b.length&&(t=Object.keys(r)[0]);var a=r[t];e.bindBuffer(e.ARRAY_BUFFER,a.buffer);var o=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);e.bindBuffer(e.ARRAY_BUFFER,null);var u=function(e,r){return r===e.BYTE?1:r===e.UNSIGNED_BYTE?1:r===e.SHORT?2:r===e.UNSIGNED_SHORT?2:r===e.INT?4:r===e.UNSIGNED_INT?4:r===e.FLOAT?4:0}(e,a.type),f=o/u,s=a.numComponents||a.size,c=f/s;if(c%1!=0)throw"numComponents "+s+" not correct for length "+length;return c}(e,o.attribs));return o},r.setAttribInfoBufferFromArray=function(e,r,t,n){t=d(t),void 0!==n?(e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferSubData(e.ARRAY_BUFFER,n,t)):u(e,e.ARRAY_BUFFER,r.buffer,t,r.drawType)},r.setAttributePrefix=function(e){i.attribPrefix=e},r.setAttributeDefaults_=function(e){a.copyExistingProperties(e,i)},r.getNumComponents_=y,r.getArray_=c;var n=o(t("./src/typedarrays.js")),a=o(t("./src/helper.js"));function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var i={attribPrefix:""};function u(e,r,t,n,a){e.bindBuffer(r,t),e.bufferData(r,n,a||e.STATIC_DRAW)}function f(e,r,t,n){if(a.isBuffer(e,r))return r;t=t||e.ARRAY_BUFFER;var o=e.createBuffer();return u(e,t,o,r,n),o}function s(e){return"indices"===e}function c(e){return e.length?e:e.data}var l=/coord|texture/i,p=/color|colour/i;function m(e,r){var t;if(r%(t=l.test(e)?2:p.test(e)?4:3)>0)throw"Can not guess numComponents for attribute '"+e+"'. Tried "+t+" but "+r+" values is not evenly divisible by "+t+". You should specify it.";return t}function y(e,r){return e.numComponents||e.size||m(r,c(e).length)}function d(e,r){if(n.isArrayBuffer(e))return e;if(n.isArrayBuffer(e.data))return e.data;Array.isArray(e)&&(e={data:e});var t=e.type;return t||(t=s(r)?Uint16Array:Float32Array),new t(e.data)}function v(e,r){var t={};return Object.keys(r).forEach(function(a){if(!s(a)){var o=r[a],u=o.attrib||o.name||o.attribName||i.attribPrefix+a;if(o.value){if(!Array.isArray(o.value)&&!n.isArrayBuffer(o.value))throw new Error("array.value is not array or typedarray");t[u]={value:o.value}}else{var c,l,p,v;if(o.buffer&&o.buffer instanceof WebGLBuffer)c=o.buffer,v=o.numComponents||o.size,l=o.type,p=o.normalize;else if("number"==typeof o||"number"==typeof o.data){var b=o.data||o,E=o.type||Float32Array,h=b*E.BYTES_PER_ELEMENT;l=n.getGLTypeForTypedArrayType(E),p=void 0!==o.normalize?o.normalize:(A=E)===Int8Array||A===Uint8Array,v=o.numComponents||o.size||m(a,b),c=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,h,o.drawType||e.STATIC_DRAW)}else{var _=d(o,a);c=f(e,_,void 0,o.drawType),l=n.getGLTypeForTypedArray(_),p=void 0!==o.normalize?o.normalize:function(e){return e instanceof Int8Array||e instanceof Uint8Array}(_),v=y(o,a)}t[u]={buffer:c,numComponents:v,type:l,normalize:p,stride:o.stride||0,offset:o.offset||0,divisor:void 0===o.divisor?void 0:o.divisor,drawType:o.drawType}}}var A}),e.bindBuffer(e.ARRAY_BUFFER,null),t}var b=["position","positions","a_position"];function E(e,r,t){var n="indices"===t?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;return f(e,d(r,t),n)}},"./src/draw.js":function(e,r,t){r.__esModule=!0,r.drawBufferInfo=a,r.drawObjectList=function(e,r){var t=null,o=null;r.forEach(function(r){if(!1!==r.active){var i=r.programInfo,u=r.vertexArrayInfo||r.bufferInfo,f=!1,s=void 0===r.type?e.TRIANGLES:r.type;i!==t&&(t=i,e.useProgram(i.program),f=!0),(f||u!==o)&&(o&&o.vertexArrayObject&&!u.vertexArrayObject&&e.bindVertexArray(null),o=u,n.setBuffersAndAttributes(e,i,u)),n.setUniforms(i,r.uniforms),a(e,u,s,r.count,r.offset,r.instanceCount)}}),o.vertexArrayObject&&e.bindVertexArray(null)};var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}(t("./src/programs.js"));function a(e,r,t,n,a,o){t=void 0===t?e.TRIANGLES:t;var i=r.indices,u=r.elementType,f=void 0===n?r.numElements:n;a=void 0===a?0:a,u||i?void 0!==o?e.drawElementsInstanced(t,f,void 0===u?e.UNSIGNED_SHORT:r.elementType,a,o):e.drawElements(t,f,void 0===u?e.UNSIGNED_SHORT:r.elementType,a):void 0!==o?e.drawArraysInstanced(t,a,f,o):e.drawArrays(t,a,f)}},"./src/framebuffers.js":function(e,r,t){r.__esModule=!0,r.bindFramebufferInfo=function(e,r,t){t=t||e.FRAMEBUFFER,r?(e.bindFramebuffer(t,r.framebuffer),e.viewport(0,0,r.width,r.height)):(e.bindFramebuffer(t,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))},r.createFramebufferInfo=function(e,r,t,o){var c=e.FRAMEBUFFER,l=e.createFramebuffer();e.bindFramebuffer(c,l),t=t||e.drawingBufferWidth,o=o||e.drawingBufferHeight;var p=0,m={framebuffer:l,attachments:[],width:t,height:o};return(r=r||u).forEach(function(r){var u=r.attachment,l=r.format,y=function(e){return f[e]}(l);if(y||(y=i+p++),!u)if(function(e){return s[e]}(l))u=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,u),e.renderbufferStorage(e.RENDERBUFFER,l,t,o);else{var d=Object.assign({},r);d.width=t,d.height=o,void 0===d.auto&&(d.auto=!1,d.min=d.min||d.minMag||e.LINEAR,d.mag=d.mag||d.minMag||e.LINEAR,d.wrapS=d.wrapS||d.wrap||e.CLAMP_TO_EDGE,d.wrapT=d.wrapT||d.wrap||e.CLAMP_TO_EDGE),u=n.createTexture(e,d)}if(a.isRenderbuffer(e,u))e.framebufferRenderbuffer(c,y,e.RENDERBUFFER,u);else{if(!a.isTexture(e,u))throw"unknown attachment type";e.framebufferTexture2D(c,y,r.texTarget||e.TEXTURE_2D,u,r.level||0)}m.attachments.push(u)}),m},r.resizeFramebufferInfo=function(e,r,t,o,i){o=o||e.drawingBufferWidth,i=i||e.drawingBufferHeight,r.width=o,r.height=i,(t=t||u).forEach(function(t,u){var f=r.attachments[u],s=t.format;if(a.isRenderbuffer(e,f))e.bindRenderbuffer(e.RENDERBUFFER,f),e.renderbufferStorage(e.RENDERBUFFER,s,o,i);else{if(!a.isTexture(e,f))throw"unknown attachment type";n.resizeTexture(e,f,t,o,i)}})};var n=o(t("./src/textures.js")),a=o(t("./src/helper.js"));function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var i=36064,u=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],f={};f[34041]=33306,f[6401]=36128,f[36168]=36128,f[6402]=36096,f[33189]=36096;var s={};s[32854]=!0,s[32855]=!0,s[36194]=!0,s[34041]=!0,s[33189]=!0,s[6401]=!0,s[36168]=!0},"./src/helper.js":function(e,r,t){r.__esModule=!0,r.copyExistingProperties=function(e,r){Object.keys(r).forEach(function(t){r.hasOwnProperty(t)&&e.hasOwnProperty(t)&&(r[t]=e[t])})},r.copyNamedProperties=function(e,r,t){e.forEach(function(e){var n=r[e];void 0!==n&&(t[e]=n)})},r.isBuffer=function(e,r){a||(a=e.createBuffer());return r instanceof a.constructor},r.isRenderbuffer=function(e,r){o||(o=e.createRenderbuffer());return r instanceof o.constructor},r.isShader=function(e,r){i||(i=e.createShader(e.VERTEX_SHADER));return r instanceof i.constructor},r.isTexture=function(e,r){u||(u=e.createTexture());return r instanceof u.constructor},r.isSampler=function(e,r){if(!f){if(!e.createSampler)return!1;f=e.createSampler()}return r instanceof f.constructor},r.warn=r.error=void 0;var n="undefined"!=typeof console&&console.error&&"function"==typeof console.error?console.error.bind(console):function(){};r.error=n;var a,o,i,u,f,s="undefined"!=typeof console&&console.warn&&"function"==typeof console.warn?console.warn.bind(console):function(){};r.warn=s},"./src/m4.js":function(e,r,t){r.__esModule=!0,r.axisRotate=function(e,r,t,n){n=n||new a(16);var o=r[0],i=r[1],u=r[2],f=Math.sqrt(o*o+i*i+u*u),s=(o/=f)*o,c=(i/=f)*i,l=(u/=f)*u,p=Math.cos(t),m=Math.sin(t),y=1-p,d=s+(1-s)*p,v=o*i*y+u*m,b=o*u*y-i*m,E=o*i*y-u*m,h=c+(1-c)*p,_=i*u*y+o*m,A=o*u*y+i*m,T=i*u*y-o*m,x=l+(1-l)*p,g=e[0],R=e[1],P=e[2],F=e[3],w=e[4],U=e[5],O=e[6],B=e[7],I=e[8],S=e[9],M=e[10],C=e[11];n[0]=d*g+v*w+b*I,n[1]=d*R+v*U+b*S,n[2]=d*P+v*O+b*M,n[3]=d*F+v*B+b*C,n[4]=E*g+h*w+_*I,n[5]=E*R+h*U+_*S,n[6]=E*P+h*O+_*M,n[7]=E*F+h*B+_*C,n[8]=A*g+T*w+x*I,n[9]=A*R+T*U+x*S,n[10]=A*P+T*O+x*M,n[11]=A*F+T*B+x*C,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]);return n},r.axisRotation=function(e,r,t){t=t||new a(16);var n=e[0],o=e[1],i=e[2],u=Math.sqrt(n*n+o*o+i*i),f=(n/=u)*n,s=(o/=u)*o,c=(i/=u)*i,l=Math.cos(r),p=Math.sin(r),m=1-l;return t[0]=f+(1-f)*l,t[1]=n*o*m+i*p,t[2]=n*i*m-o*p,t[3]=0,t[4]=n*o*m-i*p,t[5]=s+(1-s)*l,t[6]=o*i*m+n*p,t[7]=0,t[8]=n*i*m+o*p,t[9]=o*i*m-n*p,t[10]=c+(1-c)*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.copy=f,r.frustum=function(e,r,t,n,o,i,u){u=u||new a(16);var f=r-e,s=n-t,c=o-i;return u[0]=2*o/f,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2*o/s,u[6]=0,u[7]=0,u[8]=(e+r)/f,u[9]=(n+t)/s,u[10]=i/c,u[11]=-1,u[12]=0,u[13]=0,u[14]=o*i/c,u[15]=0,u},r.getAxis=function(e,r,t){t=t||n.create();var a=4*r;return t[0]=e[a+0],t[1]=e[a+1],t[2]=e[a+2],t},r.getTranslation=function(e,r){return(r=r||n.create())[0]=e[12],r[1]=e[13],r[2]=e[14],r},r.identity=s,r.inverse=c,r.lookAt=function(e,r,t,f){f=f||new a(16);var s=o,c=i,l=u;return n.normalize(n.subtract(e,r,l),l),n.normalize(n.cross(t,l,s),s),n.normalize(n.cross(l,s,c),c),f[0]=s[0],f[1]=s[1],f[2]=s[2],f[3]=0,f[4]=c[0],f[5]=c[1],f[6]=c[2],f[7]=0,f[8]=l[0],f[9]=l[1],f[10]=l[2],f[11]=0,f[12]=e[0],f[13]=e[1],f[14]=e[2],f[15]=1,f},r.multiply=function(e,r,t){t=t||new a(16);var n=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5],c=e[6],l=e[7],p=e[8],m=e[9],y=e[10],d=e[11],v=e[12],b=e[13],E=e[14],h=e[15],_=r[0],A=r[1],T=r[2],x=r[3],g=r[4],R=r[5],P=r[6],F=r[7],w=r[8],U=r[9],O=r[10],B=r[11],I=r[12],S=r[13],M=r[14],C=r[15];return t[0]=n*_+f*A+p*T+v*x,t[1]=o*_+s*A+m*T+b*x,t[2]=i*_+c*A+y*T+E*x,t[3]=u*_+l*A+d*T+h*x,t[4]=n*g+f*R+p*P+v*F,t[5]=o*g+s*R+m*P+b*F,t[6]=i*g+c*R+y*P+E*F,t[7]=u*g+l*R+d*P+h*F,t[8]=n*w+f*U+p*O+v*B,t[9]=o*w+s*U+m*O+b*B,t[10]=i*w+c*U+y*O+E*B,t[11]=u*w+l*U+d*O+h*B,t[12]=n*I+f*S+p*M+v*C,t[13]=o*I+s*S+m*M+b*C,t[14]=i*I+c*S+y*M+E*C,t[15]=u*I+l*S+d*M+h*C,t},r.negate=function(e,r){return(r=r||new a(16))[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=-e[7],r[8]=-e[8],r[9]=-e[9],r[10]=-e[10],r[11]=-e[11],r[12]=-e[12],r[13]=-e[13],r[14]=-e[14],r[15]=-e[15],r},r.ortho=function(e,r,t,n,o,i,u){return(u=u||new a(16))[0]=2/(r-e),u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2/(n-t),u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2/(o-i),u[11]=0,u[12]=(r+e)/(e-r),u[13]=(n+t)/(t-n),u[14]=(i+o)/(o-i),u[15]=1,u},r.perspective=function(e,r,t,n,o){o=o||new a(16);var i=Math.tan(.5*Math.PI-.5*e),u=1/(t-n);return o[0]=i/r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(t+n)*u,o[11]=-1,o[12]=0,o[13]=0,o[14]=t*n*u*2,o[15]=0,o},r.rotateX=function(e,r,t){t=t||new a(16);var n=e[4],o=e[5],i=e[6],u=e[7],f=e[8],s=e[9],c=e[10],l=e[11],p=Math.cos(r),m=Math.sin(r);t[4]=p*n+m*f,t[5]=p*o+m*s,t[6]=p*i+m*c,t[7]=p*u+m*l,t[8]=p*f-m*n,t[9]=p*s-m*o,t[10]=p*c-m*i,t[11]=p*l-m*u,e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotateY=function(e,r,t){t=t||new a(16);var n=e[0],o=e[1],i=e[2],u=e[3],f=e[8],s=e[9],c=e[10],l=e[11],p=Math.cos(r),m=Math.sin(r);t[0]=p*n-m*f,t[1]=p*o-m*s,t[2]=p*i-m*c,t[3]=p*u-m*l,t[8]=p*f+m*n,t[9]=p*s+m*o,t[10]=p*c+m*i,t[11]=p*l+m*u,e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotateZ=function(e,r,t){t=t||new a(16);var n=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5],c=e[6],l=e[7],p=Math.cos(r),m=Math.sin(r);t[0]=p*n+m*f,t[1]=p*o+m*s,t[2]=p*i+m*c,t[3]=p*u+m*l,t[4]=p*f-m*n,t[5]=p*s-m*o,t[6]=p*c-m*i,t[7]=p*l-m*u,e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotationX=function(e,r){r=r||new a(16);var t=Math.cos(e),n=Math.sin(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},r.rotationY=function(e,r){r=r||new a(16);var t=Math.cos(e),n=Math.sin(e);return r[0]=t,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},r.rotationZ=function(e,r){r=r||new a(16);var t=Math.cos(e),n=Math.sin(e);return r[0]=t,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},r.scale=function(e,r,t){t=t||new a(16);var n=r[0],o=r[1],i=r[2];t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=n*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=o*e[6],t[7]=o*e[7],t[8]=i*e[8],t[9]=i*e[9],t[10]=i*e[10],t[11]=i*e[11],e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.scaling=function(e,r){return(r=r||new a(16))[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},r.setAxis=function(e,r,t,n){n!==e&&(n=f(e,n));var a=4*t;return n[a+0]=r[0],n[a+1]=r[1],n[a+2]=r[2],n},r.setDefaultType=function(e){var r=a;return a=e,r},r.setTranslation=function(e,r,t){t=t||s(),e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]);return t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},r.transformDirection=function(e,r,t){t=t||n.create();var a=r[0],o=r[1],i=r[2];return t[0]=a*e[0]+o*e[4]+i*e[8],t[1]=a*e[1]+o*e[5]+i*e[9],t[2]=a*e[2]+o*e[6]+i*e[10],t},r.transformNormal=function(e,r,t){t=t||n.create();var a=c(e),o=r[0],i=r[1],u=r[2];return t[0]=o*a[0]+i*a[1]+u*a[2],t[1]=o*a[4]+i*a[5]+u*a[6],t[2]=o*a[8]+i*a[9]+u*a[10],t},r.transformPoint=function(e,r,t){t=t||n.create();var a=r[0],o=r[1],i=r[2],u=a*e[3]+o*e[7]+i*e[11]+e[15];return t[0]=(a*e[0]+o*e[4]+i*e[8]+e[12])/u,t[1]=(a*e[1]+o*e[5]+i*e[9]+e[13])/u,t[2]=(a*e[2]+o*e[6]+i*e[10]+e[14])/u,t},r.translate=function(e,r,t){t=t||new a(16);var n=r[0],o=r[1],i=r[2],u=e[0],f=e[1],s=e[2],c=e[3],l=e[4],p=e[5],m=e[6],y=e[7],d=e[8],v=e[9],b=e[10],E=e[11],h=e[12],_=e[13],A=e[14],T=e[15];e!==t&&(t[0]=u,t[1]=f,t[2]=s,t[3]=c,t[4]=l,t[5]=p,t[6]=m,t[7]=y,t[8]=d,t[9]=v,t[10]=b,t[11]=E);return t[12]=u*n+l*o+d*i+h,t[13]=f*n+p*o+v*i+_,t[14]=s*n+m*o+b*i+A,t[15]=c*n+y*o+E*i+T,t},r.translation=function(e,r){return(r=r||new a(16))[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},r.transpose=function(e,r){if((r=r||new a(16))===e){var t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,r}var n=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5],c=e[6],l=e[7],p=e[8],m=e[9],y=e[10],d=e[11],v=e[12],b=e[13],E=e[14],h=e[15];return r[0]=n,r[1]=f,r[2]=p,r[3]=v,r[4]=o,r[5]=s,r[6]=m,r[7]=b,r[8]=i,r[9]=c,r[10]=y,r[11]=E,r[12]=u,r[13]=l,r[14]=d,r[15]=h,r};var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}(t("./src/v3.js"));var a=Float32Array,o=n.create(),i=n.create(),u=n.create();function f(e,r){return(r=r||new a(16))[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function s(e){return(e=e||new a(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e,r){r=r||new a(16);var t=e[0],n=e[1],o=e[2],i=e[3],u=e[4],f=e[5],s=e[6],c=e[7],l=e[8],p=e[9],m=e[10],y=e[11],d=e[12],v=e[13],b=e[14],E=e[15],h=m*E,_=b*y,A=s*E,T=b*c,x=s*y,g=m*c,R=o*E,P=b*i,F=o*y,w=m*i,U=o*c,O=s*i,B=l*v,I=d*p,S=u*v,M=d*f,C=u*p,j=l*f,N=t*v,D=d*n,L=t*p,k=l*n,z=t*f,G=u*n,X=h*f+T*p+x*v-(_*f+A*p+g*v),V=_*n+R*p+w*v-(h*n+P*p+F*v),Y=A*n+P*f+U*v-(T*n+R*f+O*v),W=g*n+F*f+O*p-(x*n+w*f+U*p),K=1/(t*X+u*V+l*Y+d*W);return r[0]=K*X,r[1]=K*V,r[2]=K*Y,r[3]=K*W,r[4]=K*(_*u+A*l+g*d-(h*u+T*l+x*d)),r[5]=K*(h*t+P*l+F*d-(_*t+R*l+w*d)),r[6]=K*(T*t+R*u+O*d-(A*t+P*u+U*d)),r[7]=K*(x*t+w*u+U*l-(g*t+F*u+O*l)),r[8]=K*(B*c+M*y+C*E-(I*c+S*y+j*E)),r[9]=K*(I*i+N*y+k*E-(B*i+D*y+L*E)),r[10]=K*(S*i+D*c+z*E-(M*i+N*c+G*E)),r[11]=K*(j*i+L*c+G*y-(C*i+k*c+z*y)),r[12]=K*(S*m+j*b+I*s-(C*b+B*s+M*m)),r[13]=K*(L*b+B*o+D*m-(N*m+k*b+I*o)),r[14]=K*(N*s+G*b+M*o-(z*b+S*o+D*s)),r[15]=K*(z*m+C*o+k*s-(L*s+G*m+j*o)),r}},"./src/primitives.js":function(e,r,t){r.__esModule=!0,r.create3DFVertices=F,r.createAugmentedTypedArray=p,r.createCubeVertices=g,r.createPlaneVertices=A,r.createSphereVertices=T,r.createTruncatedConeVertices=R,r.createXYQuadVertices=_,r.createCresentVertices=w,r.createCylinderVertices=U,r.createTorusVertices=O,r.createDiscVertices=B,r.deindexVertices=function(e){var r=e.indices,t={},n=r.length;return Object.keys(e).filter(m).forEach(function(a){for(var o=e[a],i=o.numComponents,u=p(i,n,o.constructor),f=0;f<n;++f)for(var s=r[f],c=s*i,l=0;l<i;++l)u.push(o[c+l]);t[a]=u}),t},r.flattenNormals=function(e){if(e.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var r=e.normal,t=r.length,n=0;n<t;n+=9){var a=r[n+0],o=r[n+1],i=r[n+2],u=r[n+3],f=r[n+4],s=r[n+5],c=r[n+6],l=r[n+7],p=r[n+8],m=a+u+c,y=o+f+l,d=i+s+p,v=Math.sqrt(m*m+y*y+d*d);m/=v,y/=v,d/=v,r[n+0]=m,r[n+1]=y,r[n+2]=d,r[n+3]=m,r[n+4]=y,r[n+5]=d,r[n+6]=m,r[n+7]=y,r[n+8]=d}return e},r.makeRandomVertexColors=function(e,r){r=r||{};var t=e.position.numElements,n=p(4,t,Uint8Array),a=r.rand||function(e,r){return r<3?(t=256,Math.random()*t|0):255;var t};if(e.color=n,e.indices)for(var o=0;o<t;++o)n.push(a(o,0),a(o,1),a(o,2),a(o,3));else for(var i=r.vertsPerColor||3,u=t/i,f=0;f<u;++f)for(var s=[a(f,0),a(f,1),a(f,2),a(f,3)],c=0;c<i;++c)n.push(s);return e},r.reorientDirections=v,r.reorientNormals=b,r.reorientPositions=E,r.reorientVertices=h,r.concatVertices=function(e){for(var r,t={},n=function(n){var a=e[n];Object.keys(a).forEach(function(e){t[e]||(t[e]=[]),r||"indices"===e||(r=e);var n=a[e],o=c(n,e),i=s(n),u=i.length/o;t[e].push(u)})},a=0;a<e.length;++a)n(a);var o=t[r],i={};return Object.keys(t).forEach(function(r){var t=function(r){for(var t,n=0,a=0;a<e.length;++a){var o=e[a],i=o[r],u=s(i);n+=u.length,t&&!i.data||(t=i)}return{length:n,spec:t}}(r),n=j(t.spec,t.length);!function(r,t,n){for(var a=0,o=0,i=0;i<e.length;++i){var u=e[i],f=u[r],c=s(f);"indices"===r?(C(c,n,o,a),a+=t[i]):C(c,n,o),o+=c.length}}(r,o,s(n)),i[r]=n}),i},r.duplicateVertices=function(e){var r={};return Object.keys(e).forEach(function(t){var n=e[t],a=s(n),o=j(n,a.length);C(a,s(o),0),r[t]=o}),r},r.createDiscBuffers=r.createDiscBufferInfo=r.createTorusBuffers=r.createTorusBufferInfo=r.createCylinderBuffers=r.createCylinderBufferInfo=r.createCresentBuffers=r.createCresentBufferInfo=r.createXYQuadBuffers=r.createXYQuadBufferInfo=r.createTruncatedConeBuffers=r.createTruncatedConeBufferInfo=r.createSphereBuffers=r.createSphereBufferInfo=r.createPlaneBuffers=r.createPlaneBufferInfo=r.createCubeBuffers=r.createCubeBufferInfo=r.create3DFBuffers=r.create3DFBufferInfo=void 0;var n=f(t("./src/attributes.js")),a=f(t("./src/helper.js")),o=f(t("./src/typedarrays.js")),i=f(t("./src/m4.js")),u=f(t("./src/v3.js"));function f(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var s=n.getArray_,c=n.getNumComponents_;function l(e,r){var t=0;return e.push=function(){for(var r=0;r<arguments.length;++r){var n=arguments[r];if(n instanceof Array||o.isArrayBuffer(n))for(var a=0;a<n.length;++a)e[t++]=n[a];else e[t++]=n}},e.reset=function(e){t=e||0},e.numComponents=r,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function p(e,r,t){return l(new(t||Float32Array)(e*r),e)}function m(e){return"indices"!==e}function y(e,r,t){for(var n=e.length,a=new Float32Array(3),o=0;o<n;o+=3)t(r,[e[o],e[o+1],e[o+2]],a),e[o]=a[0],e[o+1]=a[1],e[o+2]=a[2]}function d(e,r,t){t=t||u.create();var n=r[0],a=r[1],o=r[2];return t[0]=n*e[0]+a*e[1]+o*e[2],t[1]=n*e[4]+a*e[5]+o*e[6],t[2]=n*e[8]+a*e[9]+o*e[10],t}function v(e,r){return y(e,r,i.transformDirection),e}function b(e,r){return y(e,i.inverse(r),d),e}function E(e,r){return y(e,r,i.transformPoint),e}function h(e,r){return Object.keys(e).forEach(function(t){var n=e[t];t.indexOf("pos")>=0?E(n,r):t.indexOf("tan")>=0||t.indexOf("binorm")>=0?v(n,r):t.indexOf("norm")>=0&&b(n,r)}),e}function _(e,r,t){return e=e||2,{position:{numComponents:2,data:[(r=r||0)+-1*(e*=.5),(t=t||0)+-1*e,r+1*e,t+-1*e,r+-1*e,t+1*e,r+1*e,t+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function A(e,r,t,n,a){e=e||1,r=r||1,t=t||1,n=n||1,a=a||i.identity();for(var o=(t+1)*(n+1),u=p(3,o),f=p(3,o),s=p(2,o),c=0;c<=n;c++)for(var l=0;l<=t;l++){var m=l/t,y=c/n;u.push(e*m-.5*e,0,r*y-.5*r),f.push(0,1,0),s.push(m,y)}for(var d=t+1,v=p(3,t*n*2,Uint16Array),b=0;b<n;b++)for(var E=0;E<t;E++)v.push((b+0)*d+E,(b+1)*d+E,(b+0)*d+E+1),v.push((b+1)*d+E,(b+1)*d+E+1,(b+0)*d+E+1);return h({position:u,normal:f,texcoord:s,indices:v},a)}function T(e,r,t,n,a,o,i){if(r<=0||t<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||0;for(var u=(a=a||Math.PI)-n,f=(i=i||2*Math.PI)-o,s=(r+1)*(t+1),c=p(3,s),l=p(3,s),m=p(2,s),y=0;y<=t;y++)for(var d=0;d<=r;d++){var v=d/r,b=y/t,E=f*v+o,h=u*b+n,_=Math.sin(E),A=Math.cos(E),T=Math.sin(h),x=A*T,g=Math.cos(h),R=_*T;c.push(e*x,e*g,e*R),l.push(x,g,R),m.push(1-v,b)}for(var P=r+1,F=p(3,r*t*2,Uint16Array),w=0;w<r;w++)for(var U=0;U<t;U++)F.push((U+0)*P+w,(U+0)*P+w+1,(U+1)*P+w),F.push((U+1)*P+w,(U+0)*P+w+1,(U+1)*P+w+1);return{position:c,normal:l,texcoord:m,indices:F}}var x=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function g(e){for(var r=(e=e||1)/2,t=[[-r,-r,-r],[+r,-r,-r],[-r,+r,-r],[+r,+r,-r],[-r,-r,+r],[+r,-r,+r],[-r,+r,+r],[+r,+r,+r]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],a=[[1,0],[0,0],[0,1],[1,1]],o=p(3,24),i=p(3,24),u=p(2,24),f=p(3,12,Uint16Array),s=0;s<6;++s){for(var c=x[s],l=0;l<4;++l){var m=t[c[l]],y=n[s],d=a[l];o.push(m),i.push(y),u.push(d)}var v=4*s;f.push(v+0,v+1,v+2),f.push(v+0,v+2,v+3)}return{position:o,normal:i,texcoord:u,indices:f}}function R(e,r,t,n,a,o,i){if(n<3)throw Error("radialSubdivisions must be 3 or greater");if(a<1)throw Error("verticalSubdivisions must be 1 or greater");for(var u=void 0===o||o,f=void 0===i||i,s=(u?2:0)+(f?2:0),c=(n+1)*(a+1+s),l=p(3,c),m=p(3,c),y=p(2,c),d=p(3,n*(a+s)*2,Uint16Array),v=n+1,b=Math.atan2(e-r,t),E=Math.cos(b),h=Math.sin(b),_=a+(f?2:0),A=u?-2:0;A<=_;++A){var T=A/a,x=t*T,g=void 0;A<0?(x=0,T=1,g=e):A>a?(x=t,T=1,g=r):g=e+A/a*(r-e),-2!==A&&A!==a+2||(g=0,T=0),x-=t/2;for(var R=0;R<v;++R){var P=Math.sin(R*Math.PI*2/n),F=Math.cos(R*Math.PI*2/n);l.push(P*g,x,F*g),m.push(A<0||A>a?0:P*E,A<0?-1:A>a?1:h,A<0||A>a?0:F*E),y.push(R/n,1-T)}}for(var w=0;w<a+s;++w)for(var U=0;U<n;++U)d.push(v*(w+0)+0+U,v*(w+0)+1+U,v*(w+1)+1+U),d.push(v*(w+0)+0+U,v*(w+1)+1+U,v*(w+1)+0+U);return{position:l,normal:m,texcoord:y,indices:d}}function P(e,r){r=r||[];for(var t=[],n=0;n<e.length;n+=4){var a=e[n],o=e.slice(n+1,n+4);o.push.apply(o,r);for(var i=0;i<a;++i)t.push.apply(t,o)}return t}function F(){var e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],r=P([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),t=P([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=e.length/3,a={position:p(3,n),texcoord:p(2,n),normal:p(3,n),color:p(4,n,Uint8Array),indices:p(3,n/3,Uint16Array)};a.position.push(e),a.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),a.normal.push(r),a.color.push(t);for(var o=0;o<n;++o)a.indices.push(o);return a}function w(e,r,t,n,a,o,i){if(a<=0)throw Error("subdivisionDown must be > 0");var f=2,s=(i=i||1)-(o=o||0),c=2*(a+1)*(2+f),l=p(3,c),m=p(3,c),y=p(2,c);function d(e,r,t){return e+(r-e)*t}function v(r,t,i,c,p,v){for(var b=0;b<=a;b++){var E=t/(f-1),h=b/a,_=2*(E-.5),A=(o+h*s)*Math.PI,T=Math.sin(A),x=Math.cos(A),g=d(e,r,T),R=_*n,P=x*e,F=T*g;l.push(R,P,F);var w=u.add(u.multiply([0,T,x],i),c);m.push(w),y.push(E*p+v,h)}}for(var b=0;b<f;b++){var E=2*(b/(f-1)-.5);v(r,b,[1,1,1],[0,0,0],1,0),v(r,b,[0,0,0],[E,0,0],0,0),v(t,b,[1,1,1],[0,0,0],1,0),v(t,b,[0,0,0],[E,0,0],0,1)}var h=p(3,2*a*(2+f),Uint16Array);function _(e,r){for(var t=0;t<a;++t)h.push(e+t+0,e+t+1,r+t+0),h.push(e+t+1,r+t+1,r+t+0)}var A=a+1;return _(0*A,4*A),_(5*A,7*A),_(6*A,2*A),_(3*A,1*A),{position:l,normal:m,texcoord:y,indices:h}}function U(e,r,t,n,a,o){return R(e,e,r,t,n,a,o)}function O(e,r,t,n,a,o){if(t<3)throw Error("radialSubdivisions must be 3 or greater");if(n<3)throw Error("verticalSubdivisions must be 3 or greater");a=a||0;for(var i=(o=o||2*Math.PI)-a,u=t+1,f=n+1,s=u*f,c=p(3,s),l=p(3,s),m=p(2,s),y=p(3,t*n*2,Uint16Array),d=0;d<f;++d)for(var v=d/n,b=v*Math.PI*2,E=Math.sin(b),h=e+E*r,_=Math.cos(b),A=_*r,T=0;T<u;++T){var x=T/t,g=a+x*i,R=Math.sin(g),P=Math.cos(g),F=R*h,w=P*h,U=R*E,O=P*E;c.push(F,A,w),l.push(U,_,O),m.push(x,1-v)}for(var B=0;B<n;++B)for(var I=0;I<t;++I){var S=1+I,M=1+B;y.push(u*B+I,u*M+I,u*B+S),y.push(u*M+I,u*M+S,u*B+S)}return{position:c,normal:l,texcoord:m,indices:y}}function B(e,r,t,n,a){if(r<3)throw Error("divisions must be at least 3");a=a||1,n=n||0;for(var o=(r+1)*((t=t||1)+1),i=p(3,o),u=p(3,o),f=p(2,o),s=p(3,t*r*2,Uint16Array),c=0,l=e-n,m=r+1,y=0;y<=t;++y){for(var d=n+l*Math.pow(y/t,a),v=0;v<=r;++v){var b=2*Math.PI*v/r,E=d*Math.cos(b),h=d*Math.sin(b);if(i.push(E,0,h),u.push(0,1,0),f.push(1-v/r,y/t),y>0&&v!==r){var _=c+(v+1),A=c+v,T=c+v-m,x=c+(v+1)-m;s.push(_,A,T),s.push(_,T,x)}}c+=r+1}return{position:i,normal:u,texcoord:f,indices:s}}function I(e){return function(r){var t=e.apply(this,Array.prototype.slice.call(arguments,1));return n.createBuffersFromArrays(r,t)}}function S(e){return function(r){var t=e.apply(null,Array.prototype.slice.call(arguments,1));return n.createBufferInfoFromArrays(r,t)}}var M=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function C(e,r,t,n){n=n||0;for(var a=e.length,o=0;o<a;++o)r[t+o]=e[o]+n}function j(e,r){var t=s(e),n=new t.constructor(r),o=n;return t.numComponents&&t.numElements&&l(n,t.numComponents),e.data&&(o={data:n},a.copyNamedProperties(M,e,o)),o}var N=S(F);r.create3DFBufferInfo=N;var D=I(F);r.create3DFBuffers=D;var L=S(g);r.createCubeBufferInfo=L;var k=I(g);r.createCubeBuffers=k;var z=S(A);r.createPlaneBufferInfo=z;var G=I(A);r.createPlaneBuffers=G;var X=S(T);r.createSphereBufferInfo=X;var V=I(T);r.createSphereBuffers=V;var Y=S(R);r.createTruncatedConeBufferInfo=Y;var W=I(R);r.createTruncatedConeBuffers=W;var K=S(_);r.createXYQuadBufferInfo=K;var H=I(_);r.createXYQuadBuffers=H;var $=S(w);r.createCresentBufferInfo=$;var q=I(w);r.createCresentBuffers=q;var Z=S(U);r.createCylinderBufferInfo=Z;var Q=I(U);r.createCylinderBuffers=Q;var J=S(O);r.createTorusBufferInfo=J;var ee=I(O);r.createTorusBuffers=ee;var re=S(B);r.createDiscBufferInfo=re;var te=I(B);r.createDiscBuffers=te},"./src/programs.js":function(e,r,t){r.__esModule=!0,r.createAttributeSetters=k,r.createProgram=U,r.createProgramFromScripts=function(e,r,t,n,a){for(var o=R(t,n,a),i=[],u=0;u<r.length;++u){var f=O(e,r[u],e[P[u]],o.errorCallback);if(!f)return null;i.push(f)}return U(e,i,o)},r.createProgramFromSources=B,r.createProgramInfo=function(e,r,t,n,a){var o=R(t,n,a),i=!0;if(r=r.map(function(e){if(e.indexOf("\n")<0){var r=f(e);r?e=r.text:(o.errorCallback("no element with id: "+e),i=!1)}return e}),!i)return null;var u=B(e,r,o);if(!u)return null;return G(e,u)},r.createProgramInfoFromProgram=G,r.createUniformSetters=S,r.createUniformBlockSpecFromProgram=j,r.createUniformBlockInfoFromProgram=D,r.createUniformBlockInfo=function(e,r,t){return D(e,r.program,r.uniformBlockSpec,t)},r.createTransformFeedback=function(e,r,t){var n=e.createTransformFeedback();return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n),e.useProgram(r.program),C(e,r,t),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),function(e,r,t){for(var n in r.transformFeedbackInfo&&(r=r.transformFeedbackInfo),t.attribs&&(t=t.attribs),t){var a=r[n];a&&e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a.index,null)}}(e,r,t),n},r.createTransformFeedbackInfo=M,r.bindTransformFeedbackInfo=C,r.setAttributes=z,r.setBuffersAndAttributes=function(e,r,t){t.vertexArrayObject?e.bindVertexArray(t.vertexArrayObject):(z(r.attribSetters||r,t.attribs),t.indices&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indices))},r.setUniforms=function e(r,t){var n=r.uniformSetters||r;var a=arguments.length;for(var o=1;o<a;++o){var i=arguments[o];if(Array.isArray(i))for(var u=i.length,f=0;f<u;++f)e(n,i[f]);else for(var s in i){var c=n[s];c&&c(i[s])}}},r.setUniformBlock=function(e,r,t){L(e,r,t)&&e.bufferData(e.UNIFORM_BUFFER,t.array,e.DYNAMIC_DRAW)},r.setBlockUniforms=function(e,r){var t=e.uniforms;for(var n in r){var a=t[n];if(a){var o=r[n];o.length?a.set(o):a[0]=o}}},r.bindUniformBlock=L;var n=o(t("./src/utils.js")),a=o(t("./src/helper.js"));function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var i=a.error,u=a.warn,f="undefined"!=typeof document&&document.getElementById?document.getElementById.bind(document):function(){return null},s={};function c(e,r){return s[r].bindPoint}function l(e,r){return function(t){e.uniform1i(r,t)}}function p(e,r){return function(t){e.uniform1iv(r,t)}}function m(e,r){return function(t){e.uniform2iv(r,t)}}function y(e,r){return function(t){e.uniform3iv(r,t)}}function d(e,r){return function(t){e.uniform4iv(r,t)}}function v(e,r,t,o){var i=c(0,r);return n.isWebGL2(e)?function(r){var n,u;a.isTexture(e,r)?(n=r,u=null):(n=r.texture,u=r.sampler),e.uniform1i(o,t),e.activeTexture(e.TEXTURE0+t),e.bindTexture(i,n),e.bindSampler(t,u)}:function(r){e.uniform1i(o,t),e.activeTexture(e.TEXTURE0+t),e.bindTexture(i,r)}}function b(e,r,t,o,i){for(var u=c(0,r),f=new Int32Array(i),s=0;s<i;++s)f[s]=t+s;return n.isWebGL2(e)?function(r){e.uniform1iv(o,f),r.forEach(function(r,n){var o,i;e.activeTexture(e.TEXTURE0+f[n]),a.isTexture(e,r)?(o=r,i=null):(o=r.texture,i=r.sampler),e.bindSampler(t,i),e.bindTexture(u,o)})}:function(r){e.uniform1iv(o,f),r.forEach(function(r,t){e.activeTexture(e.TEXTURE0+f[t]),e.bindTexture(u,r)})}}function E(e,r){return function(t){t.value?(e.disableVertexAttribArray(r),e.vertexAttrib4fv(r,t.value)):(e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,t.numComponents||t.size,t.type||e.FLOAT,t.normalize||!1,t.stride||0,t.offset||0),void 0!==t.divisor&&e.vertexAttribDivisor(r,t.divisor))}}function h(e,r){return function(t){t.value?(e.disableVertexAttribArray(r),e.vertexAttrib4iv(r,t.value)):(e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||e.INT,t.stride||0,t.offset||0),void 0!==t.divisor&&e.vertexAttribDivisor(r,t.divisor))}}function _(e,r){return function(t){t.value?(e.disableVertexAttribArray(r),e.vertexAttrib4uiv(r,t.value)):(e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||e.UNSIGNED_INT,t.stride||0,t.offset||0),void 0!==t.divisor&&e.vertexAttribDivisor(r,t.divisor))}}function A(e,r,t){var n=t.size,a=t.count;return function(t){e.bindBuffer(e.ARRAY_BUFFER,t.buffer);for(var o=t.size||t.numComponents||n,i=o/a,u=t.type||e.FLOAT,f=s[u].size*o,c=t.normalize||!1,l=t.offset||0,p=f/a,m=0;m<a;++m)e.enableVertexAttribArray(r+m),e.vertexAttribPointer(r+m,i,u,c,f,l+p*m),void 0!==t.divisor&&e.vertexAttribDivisor(r+m,t.divisor)}}s[5126]={Type:Float32Array,size:4,setter:function(e,r){return function(t){e.uniform1f(r,t)}},arraySetter:function(e,r){return function(t){e.uniform1fv(r,t)}}},s[35664]={Type:Float32Array,size:8,setter:function(e,r){return function(t){e.uniform2fv(r,t)}}},s[35665]={Type:Float32Array,size:12,setter:function(e,r){return function(t){e.uniform3fv(r,t)}}},s[35666]={Type:Float32Array,size:16,setter:function(e,r){return function(t){e.uniform4fv(r,t)}}},s[5124]={Type:Int32Array,size:4,setter:l,arraySetter:p},s[35667]={Type:Int32Array,size:8,setter:m},s[35668]={Type:Int32Array,size:12,setter:y},s[35669]={Type:Int32Array,size:16,setter:d},s[5125]={Type:Uint32Array,size:4,setter:function(e,r){return function(t){e.uniform1ui(r,t)}},arraySetter:function(e,r){return function(t){e.uniform1uiv(r,t)}}},s[36294]={Type:Uint32Array,size:8,setter:function(e,r){return function(t){e.uniform2uiv(r,t)}}},s[36295]={Type:Uint32Array,size:12,setter:function(e,r){return function(t){e.uniform3uiv(r,t)}}},s[36296]={Type:Uint32Array,size:16,setter:function(e,r){return function(t){e.uniform4uiv(r,t)}}},s[35670]={Type:Uint32Array,size:4,setter:l,arraySetter:p},s[35671]={Type:Uint32Array,size:8,setter:m},s[35672]={Type:Uint32Array,size:12,setter:y},s[35673]={Type:Uint32Array,size:16,setter:d},s[35674]={Type:Float32Array,size:16,setter:function(e,r){return function(t){e.uniformMatrix2fv(r,!1,t)}}},s[35675]={Type:Float32Array,size:36,setter:function(e,r){return function(t){e.uniformMatrix3fv(r,!1,t)}}},s[35676]={Type:Float32Array,size:64,setter:function(e,r){return function(t){e.uniformMatrix4fv(r,!1,t)}}},s[35685]={Type:Float32Array,size:24,setter:function(e,r){return function(t){e.uniformMatrix2x3fv(r,!1,t)}}},s[35686]={Type:Float32Array,size:32,setter:function(e,r){return function(t){e.uniformMatrix2x4fv(r,!1,t)}}},s[35687]={Type:Float32Array,size:24,setter:function(e,r){return function(t){e.uniformMatrix3x2fv(r,!1,t)}}},s[35688]={Type:Float32Array,size:48,setter:function(e,r){return function(t){e.uniformMatrix3x4fv(r,!1,t)}}},s[35689]={Type:Float32Array,size:32,setter:function(e,r){return function(t){e.uniformMatrix4x2fv(r,!1,t)}}},s[35690]={Type:Float32Array,size:48,setter:function(e,r){return function(t){e.uniformMatrix4x3fv(r,!1,t)}}},s[35678]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:3553},s[35680]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:34067},s[35679]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:32879},s[35682]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:3553},s[36289]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:35866},s[36292]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:35866},s[36293]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:34067},s[36298]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:3553},s[36299]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:32879},s[36300]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:34067},s[36303]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:35866},s[36306]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:3553},s[36307]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:32879},s[36308]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:34067},s[36311]={Type:null,size:0,setter:v,arraySetter:b,bindPoint:35866};var T={};T[5126]={size:4,setter:E},T[35664]={size:8,setter:E},T[35665]={size:12,setter:E},T[35666]={size:16,setter:E},T[5124]={size:4,setter:h},T[35667]={size:8,setter:h},T[35668]={size:12,setter:h},T[35669]={size:16,setter:h},T[5125]={size:4,setter:_},T[36294]={size:8,setter:_},T[36295]={size:12,setter:_},T[36296]={size:16,setter:_},T[35670]={size:4,setter:h},T[35671]={size:8,setter:h},T[35672]={size:12,setter:h},T[35673]={size:16,setter:h},T[35674]={size:4,setter:A,count:2},T[35675]={size:9,setter:A,count:3},T[35676]={size:16,setter:A,count:4};var x=/^[ \t]*\n/;function g(e,r,t,n){var a=n||i,o=e.createShader(t),u=0;if(x.test(r)&&(u=1,r=r.replace(x,"")),e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var f=e.getShaderInfoLog(o);return a(function(e,r){return r=r||0,++r,e.split("\n").map(function(e,t){return t+r+": "+e}).join("\n")}(r,u)+"\n*** Error compiling shader: "+f),e.deleteShader(o),null}return o}function R(e,r,t){var n;if("function"==typeof r&&(t=r,r=void 0),"function"==typeof e)t=e,e=void 0;else if(e&&!Array.isArray(e)){if(e.errorCallback)return e;var a=e;t=a.errorCallback,e=a.attribLocations,n=a.transformFeedbackVaryings}var o={errorCallback:t||i,transformFeedbackVaryings:n};if(e){var u={};Array.isArray(e)?e.forEach(function(e,t){u[e]=r?r[t]:t}):u=e,o.attribLocations=u}return o}var P=["VERTEX_SHADER","FRAGMENT_SHADER"];function F(e,r){return r.indexOf("frag")>=0?e.FRAGMENT_SHADER:r.indexOf("vert")>=0?e.VERTEX_SHADER:void 0}function w(e,r){r.forEach(function(r){e.deleteShader(r)})}function U(e,r,t,n,o){for(var i=R(t,n,o),u=[],s=[],c=0;c<r.length;++c){var l=r[c];if("string"==typeof l){var p=f(l),m=p?p.text:l,y=e[P[c]];p&&p.type&&(y=F(e,p.type)||y),l=g(e,m,y,i.errorCallback),s.push(l)}a.isShader(e,l)&&u.push(l)}if(u.length!==r.length)return i.errorCallback("not enough shaders for program"),w(e,s),null;var d=e.createProgram();u.forEach(function(r){e.attachShader(d,r)}),i.attribLocations&&Object.keys(i.attribLocations).forEach(function(r){e.bindAttribLocation(d,i.attribLocations[r],r)});var v=i.transformFeedbackVaryings;if(v&&(v.attribs&&(v=v.attribs),Array.isArray(v)||(v=Object.keys(v)),e.transformFeedbackVaryings(d,v,i.transformFeedbackMode||e.SEPARATE_ATTRIBS)),e.linkProgram(d),!e.getProgramParameter(d,e.LINK_STATUS)){var b=e.getProgramInfoLog(d);return i.errorCallback("Error in program linking:"+b),e.deleteProgram(d),w(e,s),null}return d}function O(e,r,t,n){var a,o=f(r);if(!o)throw"*** Error: unknown script element"+r;a=o.text;var i=t||F(e,o.type);if(!i)throw"*** Error: unknown shader type";return g(e,a,i,n)}function B(e,r,t,n,a){for(var o=R(t,n,a),i=[],u=0;u<r.length;++u){var f=g(e,r[u],e[P[u]],o.errorCallback);if(!f)return null;i.push(f)}return U(e,i,o)}function I(e){var r=e.name;return r.startsWith("gl_")||r.startsWith("webgl_")}function S(e,r){var t=0;function n(r,n){var a,o=e.getUniformLocation(r,n.name),i=n.size>1&&"[0]"===n.name.substr(-3),u=n.type,f=s[u];if(!f)throw"unknown type: 0x"+u.toString(16);if(f.bindPoint){var c=t;t+=n.size,a=i?f.arraySetter(e,u,c,o,n.size):f.setter(e,u,c,o,n.size)}else a=f.arraySetter&&i?f.arraySetter(e,o):f.setter(e,o);return a.location=o,a}for(var a={},o=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),i=0;i<o;++i){var u=e.getActiveUniform(r,i);if(!I(u)){var f=u.name;"[0]"===f.substr(-3)&&(f=f.substr(0,f.length-3));var c=n(r,u);a[f]=c}}return a}function M(e,r){for(var t={},n=e.getProgramParameter(r,e.TRANSFORM_FEEDBACK_VARYINGS),a=0;a<n;++a){var o=e.getTransformFeedbackVarying(r,a);t[o.name]={index:a,type:o.type,size:o.size}}return t}function C(e,r,t){for(var n in r.transformFeedbackInfo&&(r=r.transformFeedbackInfo),t.attribs&&(t=t.attribs),t){var a=r[n];if(a){var o=t[n];o.offset?e.bindBufferRange(e.TRANSFORM_FEEDBACK_BUFFER,a.index,o.buffer,o.offset,o.size):e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a.index,o.buffer)}}}function j(e,r){for(var t=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),n=[],a=[],o=0;o<t;++o){a.push(o),n.push({});var i=e.getActiveUniform(r,o);if(I(i))break;n[o].name=i.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(t){var o=t[0],i=t[1];e.getActiveUniforms(r,a,e[o]).forEach(function(e,r){n[r][i]=e})});for(var u={},f=e.getProgramParameter(r,e.ACTIVE_UNIFORM_BLOCKS),s=0;s<f;++s){var c=e.getActiveUniformBlockName(r,s),l={index:s,usedByVertexShader:e.getActiveUniformBlockParameter(r,s,e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:e.getActiveUniformBlockParameter(r,s,e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:e.getActiveUniformBlockParameter(r,s,e.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:e.getActiveUniformBlockParameter(r,s,e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};l.used=l.usedByVertexSahder||l.usedByFragmentShader,u[c]=l}return{blockSpecs:u,uniformData:n}}var N=/\[\d+\]\.$/;function D(e,r,t,n){var a=t.blockSpecs,o=t.uniformData,i=a[n];if(!i)return u("no uniform block object named:",n),{name:n,uniforms:{}};var f=new ArrayBuffer(i.size),c=e.createBuffer(),l=i.index;e.bindBuffer(e.UNIFORM_BUFFER,c),e.uniformBlockBinding(r,i.index,l);var p=n+".";N.test(p)&&(p=p.replace(N,"."));var m={};return i.uniformIndices.forEach(function(e){var r=o[e],t=s[r.type],n=t.Type,a=r.size*t.size,i=r.name;i.substr(0,p.length)===p&&(i=i.substr(p.length)),m[i]=new n(f,r.offset,a/n.BYTES_PER_ELEMENT)}),{name:n,array:f,asFloat:new Float32Array(f),buffer:c,uniforms:m}}function L(e,r,t){var n=(r.uniformBlockSpec||r).blockSpecs[t.name];if(n){var a=n.index;return e.bindBufferRange(e.UNIFORM_BUFFER,a,t.buffer,t.offset||0,t.array.byteLength),!0}return!1}function k(e,r){for(var t={},n=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES),a=0;a<n;++a){var o=e.getActiveAttrib(r,a);if(!I(o)){var i=e.getAttribLocation(r,o.name),u=T[o.type],f=u.setter(e,i,u);f.location=i,t[o.name]=f}}return t}function z(e,r){for(var t in r){var n=e[t];n&&n(r[t])}}function G(e,r){var t={program:r,uniformSetters:S(e,r),attribSetters:k(e,r)};return n.isWebGL2(e)&&(t.uniformBlockSpec=j(e,r),t.transformFeedbackInfo=M(e,r)),t}},"./src/textures.js":function(e,r,t){r.__esModule=!0,r.setTextureDefaults_=function(e){o.copyExistingProperties(e,u),e.textureColor&&x(e.textureColor)},r.createSampler=I,r.createSamplers=function(e,r){var t={};return Object.keys(r).forEach(function(n){t[n]=I(e,r[n])}),t},r.setSamplerParameters=B,r.createTexture=H,r.setEmptyTexture=K,r.setTextureFromArray=W,r.loadTextureFromUrl=X,r.setTextureFromElement=N,r.setTextureFilteringForSize=S,r.setTextureParameters=O,r.setDefaultTextureColor=x,r.createTextures=function(e,r,t){t=t||D;var n=0,a=[],o={},i={};function u(){0===n&&setTimeout(function(){t(a.length?a:void 0,o,i)},0)}return Object.keys(r).forEach(function(t){var f,s,c=r[t];("string"==typeof(s=c.src)||Array.isArray(s)&&"string"==typeof s[0])&&(f=function(e,r,o){i[t]=o,--n,e&&a.push(e),u()},++n),o[t]=H(e,c,f)}),u(),o},r.resizeTexture=function(e,r,t,n,a){n=n||t.width,a=a||t.height;var o=t.target||e.TEXTURE_2D;e.bindTexture(o,r);var i,u=t.level||0,s=t.internalFormat||t.format||e.RGBA,c=b(s),l=t.format||c.format,p=t.src;i=p&&(f(p)||Array.isArray(p)&&"number"==typeof p[0])?t.type||A(e,p,c.type):t.type||c.type;if(o===e.TEXTURE_CUBE_MAP)for(var m=0;m<6;++m)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,u,s,n,a,0,l,i,null);else e.texImage2D(o,u,s,n,a,0,l,i,null)},r.canGenerateMipmap=h,r.canFilter=_,r.getNumComponentsForFormat=function(e){var r=p[e];if(!r)throw"unknown format: "+e;return r.numColorComponents},r.getBytesPerElementForInternalFormat=v,r.getFormatAndTypeForInternalFormat=b;var n=i(t("./src/utils.js")),a=i(t("./src/typedarrays.js")),o=i(t("./src/helper.js"));function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}var u={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},f=a.isArrayBuffer,s="undefined"!=typeof document&&document.createElement?document.createElement("canvas").getContext("2d"):null,c=6407,l=33319,p={},m=p;m[6406]={numColorComponents:1},m[6409]={numColorComponents:1},m[6410]={numColorComponents:2},m[c]={numColorComponents:3},m[6408]={numColorComponents:4},m[6403]={numColorComponents:1},m[36244]={numColorComponents:1},m[l]={numColorComponents:2},m[33320]={numColorComponents:2},m[c]={numColorComponents:3},m[36248]={numColorComponents:3},m[6408]={numColorComponents:4},m[36249]={numColorComponents:4},m[6402]={numColorComponents:1},m[34041]={numColorComponents:2};var y={},d=y;function v(e,r){var t=y[e];if(!t)throw"unknown internal format";var n=t.bytesPerElementMap[r];if(void 0===n)throw"unknown internal format";return n}function b(e){var r=y[e];if(!r)throw"unknown internal format";return{format:r.textureFormat,type:r.type[0]}}function E(e){return 0==(e&e-1)}function h(e,r,t,a){if(!n.isWebGL2(e))return E(r)&&E(t);var o=y[a];if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}function _(e){var r=y[e];if(!r)throw"unknown internal format";return r.textureFilterable}function A(e,r,t){return f(r)?a.getGLTypeForTypedArray(r):t||e.UNSIGNED_BYTE}function T(e,r,t,n,a){if(a%1!=0)throw"can't guess dimensions";if(t||n){if(n){if(!t&&(t=a/n)%1)throw"can't guess dimensions"}else if((n=a/t)%1)throw"can't guess dimensions"}else{var o=Math.sqrt(a/(r===e.TEXTURE_CUBE_MAP?6:1));o%1==0?(t=o,n=o):(t=a,n=1)}return{width:t,height:n}}function x(e){u.textureColor=new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}d[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},d[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},d[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},d[c]={textureFormat:c,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},d[6408]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},d[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[5121]},d[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[5120]},d[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},d[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[5126]},d[33330]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[5121]},d[33329]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[5120]},d[33332]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5123]},d[33331]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5122]},d[33334]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5125]},d[33333]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5124]},d[33323]={textureFormat:l,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[5121]},d[36757]={textureFormat:l,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[5120]},d[33327]={textureFormat:l,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},d[33328]={textureFormat:l,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[5126]},d[33336]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5121]},d[33335]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5120]},d[33338]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5123]},d[33337]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5122]},d[33340]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5125]},d[33339]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5124]},d[32849]={textureFormat:c,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[5121]},d[35905]={textureFormat:c,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[5121]},d[36194]={textureFormat:c,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},d[36758]={textureFormat:c,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[5120]},d[35898]={textureFormat:c,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},d[35901]={textureFormat:c,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},d[34843]={textureFormat:c,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},d[34837]={textureFormat:c,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5126]},d[36221]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[5121]},d[36239]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[5120]},d[36215]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5123]},d[36233]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5122]},d[36209]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5125]},d[36227]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5124]},d[32856]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[5121]},d[35907]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[5121]},d[36759]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[5120]},d[32855]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},d[32854]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},d[32857]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[33640]},d[34842]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},d[34836]={textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[5126]},d[36220]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5121]},d[36238]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5120]},d[36975]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[33640]},d[36214]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5123]},d[36232]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5122]},d[36226]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5124]},d[36208]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5125]},d[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},d[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5125]},d[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5126]},d[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[34042]},d[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[36269]},Object.keys(d).forEach(function(e){var r=d[e];r.bytesPerElementMap={},r.bytesPerElement.forEach(function(e,t){var n=r.type[t];r.bytesPerElementMap[n]=e})});var g={};function R(e,r){void 0!==r.colorspaceConversion&&(g.colorspaceConversion=e.getParameter(e.UNPACK_COLORSPACE_CONVERSION_WEBGL),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.colorspaceConversion)),void 0!==r.premultiplyAlpha&&(g.premultiplyAlpha=e.getParameter(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha)),void 0!==r.flipY&&(g.flipY=e.getParameter(e.UNPACK_FLIP_Y_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY))}function P(e,r){void 0!==r.colorspaceConversion&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.colorspaceConversion),void 0!==r.premultiplyAlpha&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g.premultiplyAlpha),void 0!==r.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,g.flipY)}function F(e){g.unpackAlignment=e.getParameter(e.UNPACK_ALIGNMENT),n.isWebGL2(e)&&(g.unpackRowLength=e.getParameter(e.UNPACK_ROW_LENGTH),g.unpackImageHeight=e.getParameter(e.UNPACK_IMAGE_HEIGHT),g.unpackSkipPixels=e.getParameter(e.UNPACK_SKIP_PIXELS),g.unpackSkipRows=e.getParameter(e.UNPACK_SKIP_ROWS),g.unpackSkipImages=e.getParameter(e.UNPACK_SKIP_IMAGES))}function w(e){e.pixelStorei(e.UNPACK_ALIGNMENT,g.unpackAlignment),n.isWebGL2(e)&&(e.pixelStorei(e.UNPACK_ROW_LENGTH,g.unpackRowLength),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,g.unpackImageHeight),e.pixelStorei(e.UNPACK_SKIP_PIXELS,g.unpackSkipPixels),e.pixelStorei(e.UNPACK_SKIP_ROWS,g.unpackSkipRows),e.pixelStorei(e.UNPACK_SKIP_IMAGES,g.unpackSkipImages))}function U(e,r,t,n){n.minMag&&(t.call(e,r,e.TEXTURE_MIN_FILTER,n.minMag),t.call(e,r,e.TEXTURE_MAG_FILTER,n.minMag)),n.min&&t.call(e,r,e.TEXTURE_MIN_FILTER,n.min),n.mag&&t.call(e,r,e.TEXTURE_MAG_FILTER,n.mag),n.wrap&&(t.call(e,r,e.TEXTURE_WRAP_S,n.wrap),t.call(e,r,e.TEXTURE_WRAP_T,n.wrap),(r===e.TEXTURE_3D||o.isSampler(e,r))&&t.call(e,r,e.TEXTURE_WRAP_R,n.wrap)),n.wrapR&&t.call(e,r,e.TEXTURE_WRAP_R,n.wrapR),n.wrapS&&t.call(e,r,e.TEXTURE_WRAP_S,n.wrapS),n.wrapT&&t.call(e,r,e.TEXTURE_WRAP_T,n.wrapT),n.minLod&&t.call(e,r,e.TEXTURE_MIN_LOD,n.minLod),n.maxLod&&t.call(e,r,e.TEXTURE_MAX_LOD,n.maxLod),n.baseLevel&&t.call(e,r,e.TEXTURE_BASE_LEVEL,n.baseLevel),n.maxLevel&&t.call(e,r,e.TEXTURE_MAX_LEVEL,n.maxLevel)}function O(e,r,t){var n=t.target||e.TEXTURE_2D;e.bindTexture(n,r),U(e,n,e.texParameteri,t)}function B(e,r,t){U(e,r,e.samplerParameteri,t)}function I(e,r){var t=e.createSampler();return B(e,t,r),t}function S(e,r,t,n,a,o,i){t=t||u.textureOptions,o=o||e.RGBA,i=i||e.UNSIGNED_BYTE;var f=t.target||e.TEXTURE_2D;if(n=n||t.width,a=a||t.height,e.bindTexture(f,r),h(e,n,a,o))e.generateMipmap(f);else{var s=_(o)?e.LINEAR:e.NEAREST;e.texParameteri(f,e.TEXTURE_MIN_FILTER,s),e.texParameteri(f,e.TEXTURE_MAG_FILTER,s),e.texParameteri(f,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(f,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}}function M(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function C(e,r){return(r=r||{}).cubeFaceOrder||[e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function j(e,r){var t=C(e,r).map(function(e,r){return{face:e,ndx:r}});return t.sort(function(e,r){return e.face-r.face}),t}function N(e,r,t,n){var a=(n=n||u.textureOptions).target||e.TEXTURE_2D,o=n.level||0,i=t.width,f=t.height,c=n.internalFormat||n.format||e.RGBA,l=b(c),p=n.format||l.format,m=n.type||l.type;if(R(e,n),e.bindTexture(a,r),a===e.TEXTURE_CUBE_MAP){var y,d,v=t.width,E=t.height;if(v/6===E)y=E,d=[0,0,1,0,2,0,3,0,4,0,5,0];else if(E/6===v)y=v,d=[0,0,0,1,0,2,0,3,0,4,0,5];else if(v/3==E/2)y=v/3,d=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(v/2!=E/3)throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);y=v/2,d=[0,0,1,0,0,1,1,1,0,2,1,2]}s?(s.canvas.width=y,s.canvas.height=y,i=y,f=y,j(e,n).forEach(function(r){var n=d[2*r.ndx+0]*y,a=d[2*r.ndx+1]*y;s.drawImage(t,n,a,y,y,0,0,y,y),e.texImage2D(r.face,o,c,p,m,s.canvas)}),s.canvas.width=1,s.canvas.height=1):"undefined"!=typeof createImageBitmap&&(i=y,f=y,j(e,n).forEach(function(u){var s=d[2*u.ndx+0]*y,l=d[2*u.ndx+1]*y;e.texImage2D(u.face,o,c,y,y,0,p,m,null),createImageBitmap(t,s,l,y,y,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(t){R(e,n),e.bindTexture(a,r),e.texImage2D(u.face,o,c,p,m,t),P(e,n),M(n)&&S(e,r,n,i,f,c,m)})}))}else if(a===e.TEXTURE_3D||a===e.TEXTURE_2D_ARRAY){var h=Math.min(t.width,t.height),_=Math.max(t.width,t.height),A=_/h;if(A%1!=0)throw"can not compute 3D dimensions of element";var T=t.width===_?1:0,x=t.height===_?1:0;F(e),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_ROW_LENGTH,t.width),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.texImage3D(a,o,c,h,h,h,0,p,m,null);for(var g=0;g<A;++g){var U=g*h*T,B=g*h*x;e.pixelStorei(e.UNPACK_SKIP_PIXELS,U),e.pixelStorei(e.UNPACK_SKIP_ROWS,B),e.texSubImage3D(a,o,0,0,g,h,h,1,p,m,t)}w(e)}else e.texImage2D(a,o,c,p,m,t);P(e,n),M(n)&&S(e,r,n,i,f,c,m),O(e,r,n)}function D(){}function L(e,r){return void 0!==r||function(e){if("undefined"!=typeof document){var r=document.createElement("a");return r.href=e,r.hostname===location.hostname&&r.port===location.port&&r.protocol===location.protocol}var t=new URL(location.href).origin;return new URL(e,location.href).origin===t}(e)?r:"anonymous"}function k(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function z(e,r,t){return k(e)?(setTimeout(function(){t(null,e)}),e):function(e,r,t){var n;if(t=t||D,r=void 0!==r?r:u.crossOrigin,r=L(e,r),"undefined"!=typeof Image){n=new Image,void 0!==r&&(n.crossOrigin=r);var a=function(){n.removeEventListener("error",i),n.removeEventListener("load",f),n=null},i=function(){var r="couldn't load image: "+e;o.error(r),t(r,n),a()},f=function(){t(null,n),a()};return n.addEventListener("error",i),n.addEventListener("load",f),n.src=e,n}if("undefined"!=typeof ImageBitmap){var s,c,l=function(){t(s,c)},p={};r&&(p.mode="cors"),fetch(e,p).then(function(e){if(!e.ok)throw e;return e.blob()}).then(function(e){return createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(e){c=e,setTimeout(l)}).catch(function(e){s=e,setTimeout(l)}),n=null}return n}(e,r,t)}function G(e,r,t){var n=(t=t||u.textureOptions).target||e.TEXTURE_2D;if(e.bindTexture(n,r),!1!==t.color){var a=function(e){return e=e||u.textureColor,f(e)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(t.color);if(n===e.TEXTURE_CUBE_MAP)for(var o=0;o<6;++o)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);else n===e.TEXTURE_3D||n===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a)}}function X(e,r,t,n){return n=n||D,t=t||u.textureOptions,G(e,r,t),z((t=Object.assign({},t)).src,t.crossOrigin,function(a,o){a?n(a,r,o):(N(e,r,o,t),n(null,r,o))})}function V(e,r,t,n){n=n||D;var a=t.src;if(6!==a.length)throw"there must be 6 urls for a cubemap";var o=t.level||0,i=t.internalFormat||t.format||e.RGBA,u=b(i),f=t.format||u.format,s=t.type||e.UNSIGNED_BYTE,c=t.target||e.TEXTURE_2D;if(c!==e.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";G(e,r,t),t=Object.assign({},t);var l,p=6,m=[],y=C(e,t);l=a.map(function(a,u){return z(a,t.crossOrigin,(d=y[u],function(a,u){--p,a?m.push(a):u.width!==u.height?m.push("cubemap face img is not a square: "+u.src):(R(e,t),e.bindTexture(c,r),5===p?C(e).forEach(function(r){e.texImage2D(r,o,i,f,s,u)}):e.texImage2D(d,o,i,f,s,u),P(e,t),M(t)&&e.generateMipmap(c)),0===p&&n(m.length?m:void 0,r,l)}));var d})}function Y(e,r,t,n){n=n||D;var a=t.src,o=t.internalFormat||t.format||e.RGBA,i=b(o),u=t.format||i.format,f=t.type||e.UNSIGNED_BYTE,c=t.target||e.TEXTURE_2D_ARRAY;if(c!==e.TEXTURE_3D&&c!==e.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";G(e,r,t),t=Object.assign({},t);var l,p=a.length,m=[],y=t.level||0,d=t.width,v=t.height,E=a.length,h=!0;l=a.map(function(a,i){return z(a,t.crossOrigin,(b=i,function(a,i){if(--p,a)m.push(a);else{if(R(e,t),e.bindTexture(c,r),h){h=!1,d=t.width||i.width,v=t.height||i.height,e.texImage3D(c,y,o,d,v,E,0,u,f,null);for(var _=0;_<E;++_)e.texSubImage3D(c,y,0,0,_,d,v,1,u,f,i)}else{var A=i;i.width===d&&i.height===v||(A=s.canvas,s.canvas.width=d,s.canvas.height=v,s.drawImage(i,0,0,d,v)),e.texSubImage3D(c,y,0,0,b,d,v,1,u,f,A),A===s.canvas&&(s.canvas.width=0,s.canvas.height=0)}P(e,t),M(t)&&e.generateMipmap(c)}0===p&&n(m.length?m:void 0,r,l)}));var b})}function W(e,r,t,o){var i=(o=o||u.textureOptions).target||e.TEXTURE_2D;e.bindTexture(i,r);var s=o.width,c=o.height,l=o.depth,p=o.level||0,m=o.internalFormat||o.format||e.RGBA,y=b(m),d=o.format||y.format,E=o.type||A(e,t,y.type);if(f(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{var h=a.getTypedArrayTypeForGLType(E);t=new h(t)}var _,x=v(m,E),g=t.byteLength/x;if(g%1)throw"length wrong size for format: "+n.glEnumToString(e,d);if(i===e.TEXTURE_3D){if(s||c||l)!s||c&&l?!c||s&&l?(_=T(e,i,s,c,g/l),s=_.width,c=_.height):(_=T(e,i,s,l,g/c),s=_.width,l=_.height):(_=T(e,i,c,l,g/s),c=_.width,l=_.height);else{var U=Math.cbrt(g);if(U%1!=0)throw"can't guess cube size of array of numElements: "+g;s=U,c=U,l=U}}else _=T(e,i,s,c,g),s=_.width,c=_.height;if(F(e),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment||1),R(e,o),i===e.TEXTURE_CUBE_MAP){var O=g/6*(x/t.BYTES_PER_ELEMENT);j(e,o).forEach(function(r){var n=O*r.ndx,a=t.subarray(n,n+O);e.texImage2D(r.face,p,m,s,c,0,d,E,a)})}else i===e.TEXTURE_3D?e.texImage3D(i,p,m,s,c,l,0,d,E,t):e.texImage2D(i,p,m,s,c,0,d,E,t);return P(e,o),w(e),{width:s,height:c,depth:l,type:E}}function K(e,r,t){var n=t.target||e.TEXTURE_2D;e.bindTexture(n,r);var a=t.level||0,o=t.internalFormat||t.format||e.RGBA,i=b(o),u=t.format||i.format,f=t.type||i.type;if(R(e,t),n===e.TEXTURE_CUBE_MAP)for(var s=0;s<6;++s)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,a,o,t.width,t.height,0,u,f,null);else n===e.TEXTURE_3D?e.texImage3D(n,a,o,t.width,t.height,t.depth,0,u,f,null):e.texImage2D(n,a,o,t.width,t.height,0,u,f,null);P(e,t)}function H(e,r,t){t=t||D,r=r||u.textureOptions;var n=e.createTexture(),a=r.target||e.TEXTURE_2D,o=r.width||1,i=r.height||1,s=r.internalFormat||e.RGBA,c=b(s),l=r.type||c.type;e.bindTexture(a,n),a===e.TEXTURE_CUBE_MAP&&(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE));var p=r.src;if(p){if("function"==typeof p&&(p=p(e,r)),"string"==typeof p)X(e,n,r,t);else if(f(p)||Array.isArray(p)&&("number"==typeof p[0]||Array.isArray(p[0])||f(p[0]))){var m=W(e,n,p,r);o=m.width,i=m.height,l=m.type}else if(Array.isArray(p)&&("string"==typeof p[0]||k(p[0])))a===e.TEXTURE_CUBE_MAP?V(e,n,r,t):Y(e,n,r,t);else{if(!k(p))throw"unsupported src type";N(e,n,p,r),o=p.width,i=p.height}}else K(e,n,r);return M(r)&&S(e,n,r,o,i,s,l),O(e,n,r),n}},"./src/twgl-full.js":function(e,r,t){r.__esModule=!0;var n={m4:!0,v3:!0,primitives:!0};r.primitives=r.v3=r.m4=void 0;var a=f(t("./src/m4.js"));r.m4=a;var o=f(t("./src/v3.js"));r.v3=o;var i=f(t("./src/primitives.js"));r.primitives=i;var u=t("./src/twgl.js");function f(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=u[e]))})},"./src/twgl.js":function(e,r,t){r.__esModule=!0;var n={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0};r.addExtensionsToContext=E,r.getContext=function(e,r){return function(e,r){for(var t=["webgl2","webgl","experimental-webgl"],n=null,a=0;a<t.length;++a)if(n=e.getContext(t[a],r)){y.addExtensionsToContext&&E(n);break}return n}(e,r)},r.getWebGLContext=function(e,r){return function(e,r){for(var t=["webgl","experimental-webgl"],n=null,a=0;a<t.length;++a)if(n=e.getContext(t[a],r)){y.addExtensionsToContext&&E(n);break}return n}(e,r)},r.resizeCanvasToDisplaySize=function(e,r){r=r||1,r=Math.max(0,r);var t=e.clientWidth*r|0,n=e.clientHeight*r|0;if(e.width!==t||e.height!==n)return e.width=t,e.height=n,!0;return!1},r.setDefaults=function(e){i.copyExistingProperties(e,y),a.setAttributeDefaults_(e),o.setTextureDefaults_(e)};var a=m(t("./src/attributes.js"));Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=a[e]))});var o=m(t("./src/textures.js"));Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=o[e]))});var i=m(t("./src/helper.js")),u=m(t("./src/utils.js"));Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=u[e]))});var f=t("./src/draw.js");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=f[e]))});var s=t("./src/framebuffers.js");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=s[e]))});var c=t("./src/programs.js");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=c[e]))});var l=t("./src/typedarrays.js");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=l[e]))});var p=t("./src/vertex-arrays.js");function m(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(r[e]=p[e]))});var y={addExtensionsToContext:!0};var d=/^(.*?)_/;function v(e,r){u.glEnumToString(e,0);var t=e.getExtension(r);if(t){var n={},a=d.exec(r)[1],o="_"+a;for(var f in t){var s=t[f],c="function"==typeof s,l=c?a:o,p=f;f.endsWith(l)&&(p=f.substring(0,f.length-l.length)),void 0!==e[p]?c||e[p]===s||i.warn(p,e[p],s,f):c?e[p]=function(e){return function(){return e.apply(t,arguments)}}(s):(e[p]=s,n[p]=s)}n.constructor={name:t.constructor.name},u.glEnumToString(n,0)}return t}var b=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function E(e){for(var r=0;r<b.length;++r)v(e,b[r])}},"./src/typedarrays.js":function(e,r,t){r.__esModule=!0,r.getGLTypeForTypedArray=function(e){if(e instanceof Int8Array)return n;if(e instanceof Uint8Array)return a;if(e instanceof Uint8ClampedArray)return a;if(e instanceof Int16Array)return o;if(e instanceof Uint16Array)return i;if(e instanceof Int32Array)return u;if(e instanceof Uint32Array)return f;if(e instanceof Float32Array)return s;throw"unsupported typed array type"},r.getGLTypeForTypedArrayType=function(e){if(e===Int8Array)return n;if(e===Uint8Array)return a;if(e===Uint8ClampedArray)return a;if(e===Int16Array)return o;if(e===Uint16Array)return i;if(e===Int32Array)return u;if(e===Uint32Array)return f;if(e===Float32Array)return s;throw"unsupported typed array type"},r.getTypedArrayTypeForGLType=function(e){var r=c[e];if(!r)throw"unknown gl type";return r},r.isArrayBuffer=void 0;var n=5120,a=5121,o=5122,i=5123,u=5124,f=5125,s=5126,c={},l=c;l[n]=Int8Array,l[a]=Uint8Array,l[o]=Int16Array,l[i]=Uint16Array,l[u]=Int32Array,l[f]=Uint32Array,l[s]=Float32Array,l[32819]=Uint16Array,l[32820]=Uint16Array,l[33635]=Uint16Array,l[5131]=Uint16Array,l[33640]=Uint32Array,l[35899]=Uint32Array,l[35902]=Uint32Array,l[36269]=Uint32Array,l[34042]=Uint32Array;var p="undefined"!=typeof SharedArrayBuffer?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};r.isArrayBuffer=p},"./src/utils.js":function(e,r,t){r.__esModule=!0,r.isWebGL1=function(e){return!e.texStorage2D},r.isWebGL2=function(e){return!!e.texStorage2D},r.glEnumToString=void 0;var n=function(){var e={},r={};return function(t,n){return function(t){var n=t.constructor.name;if(!e[n]){for(var a in t)if("number"==typeof t[a]){var o=r[t[a]];r[t[a]]=o?"".concat(o," | ").concat(a):a}e[n]=!0}}(t),r[n]||"0x"+n.toString(16)}}();r.glEnumToString=n},"./src/v3.js":function(e,r,t){r.__esModule=!0,r.add=function(e,r,t){return(t=t||new n(3))[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},r.copy=function(e,r){return(r=r||new n(3))[0]=e[0],r[1]=e[1],r[2]=e[2],r},r.create=function(e,r,t){var a=new n(3);e&&(a[0]=e);r&&(a[1]=r);t&&(a[2]=t);return a},r.cross=function(e,r,t){t=t||new n(3);var a=e[2]*r[0]-e[0]*r[2],o=e[0]*r[1]-e[1]*r[0];return t[0]=e[1]*r[2]-e[2]*r[1],t[1]=a,t[2]=o,t},r.distance=function(e,r){var t=e[0]-r[0],n=e[1]-r[1],a=e[2]-r[2];return Math.sqrt(t*t+n*n+a*a)},r.distanceSq=function(e,r){var t=e[0]-r[0],n=e[1]-r[1],a=e[2]-r[2];return t*t+n*n+a*a},r.divide=function(e,r,t){return(t=t||new n(3))[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},r.divScalar=function(e,r,t){return(t=t||new n(3))[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r,t},r.dot=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},r.lerp=function(e,r,t,a){return(a=a||new n(3))[0]=e[0]+t*(r[0]-e[0]),a[1]=e[1]+t*(r[1]-e[1]),a[2]=e[2]+t*(r[2]-e[2]),a},r.lerpV=function(e,r,t,a){return(a=a||new n(3))[0]=e[0]+t[0]*(r[0]-e[0]),a[1]=e[1]+t[1]*(r[1]-e[1]),a[2]=e[2]+t[2]*(r[2]-e[2]),a},r.length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},r.lengthSq=function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},r.max=function(e,r,t){return(t=t||new n(3))[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},r.min=function(e,r,t){return(t=t||new n(3))[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},r.mulScalar=function(e,r,t){return(t=t||new n(3))[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},r.multiply=function(e,r,t){return(t=t||new n(3))[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},r.negate=function(e,r){return(r=r||new n(3))[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r},r.normalize=function(e,r){r=r||new n(3);var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],a=Math.sqrt(t);a>1e-5?(r[0]=e[0]/a,r[1]=e[1]/a,r[2]=e[2]/a):(r[0]=0,r[1]=0,r[2]=0);return r},r.setDefaultType=function(e){var r=n;return n=e,r},r.subtract=function(e,r,t){return(t=t||new n(3))[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t};var n=Float32Array},"./src/vertex-arrays.js":function(e,r,t){r.__esModule=!0,r.createVertexArrayInfo=function(e,r,t){var a=e.createVertexArray();e.bindVertexArray(a),r.length||(r=[r]);return r.forEach(function(r){n.setBuffersAndAttributes(e,r,t)}),e.bindVertexArray(null),{numElements:t.numElements,elementType:t.elementType,vertexArrayObject:a}},r.createVAOAndSetAttributes=a,r.createVAOFromBufferInfo=function(e,r,t){return a(e,r.attribSetters||r,t.attribs,t.indices)};var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}(t("./src/programs.js"));function a(e,r,t,a){var o=e.createVertexArray();return e.bindVertexArray(o),n.setAttributes(r,t),a&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bindVertexArray(null),o}}})});var Md={};function Qd(e){if(e===window||e===document.body)return[window.innerWidth,window.innerHeight];if(!e.parentNode){var r=!0;document.body.appendChild(e)}var t=e.getBoundingClientRect(),a=getComputedStyle(e),n=(0|t.height)+na(a.getPropertyValue("margin-top"))+na(a.getPropertyValue("margin-bottom")),o=(0|t.width)+na(a.getPropertyValue("margin-left"))+na(a.getPropertyValue("margin-right"));return r&&document.body.removeChild(e),[o,n]}function na(e){return parseFloat(e)||0}Md=Qd;var Sd={};Sd=Vd;var xb=new Float32Array(2);function Vd(t,e,r){var i="SVG"===t.nodeName.toUpperCase();return t.style.position=t.style.position||"absolute",t.style.top=0,t.style.left=0,a.scale=parseFloat(r||1),a.parent=e,a();function a(){var e=a.parent||t.parentNode;if("function"==typeof e)var r=e(xb)||xb,s=r[0],$=r[1];else if(e&&e!==document.body){var n=Md(e);s=0|n[0],$=0|n[1]}else s=window.innerWidth,$=window.innerHeight;return i?(t.setAttribute("width",s*a.scale+"px"),t.setAttribute("height",$*a.scale+"px")):(t.width=s*a.scale,t.height=$*a.scale),t.style.width=s+"px",t.style.height=$+"px",a}}const Xd=($,{init:a,update:e,release:s},t)=>{let n,r,o=0,p=0;return{init(s,c,...v){ce(n=s,n.width,n.height),r=n.getContext($,t),p=Date.now(),a&&a(n,r,c,...v),e&&e(n,r,c,p,o++,...v)},render:($,...a)=>(r&&e&&e(n,r,$,Date.now()-p,o++,...a),["canvas",a[0]]),release($,...a){s&&s(n,r,$,...a)}}},Yd=($,a)=>Xd("webgl",$,a);const ce=($,a,e)=>{const s=window.devicePixelRatio||1;return 1!=s&&($.style.width=`${a}px`,$.style.height=`${e}px`),$.width=a*s,$.height=e*s,s};class he{set params(p){}init(p){this.gl=p}render(p,s){}}const Yh=Object.freeze([-1/0,-1/0]);const Xh=Object.freeze([1/0,1/0]);const Wh=Object.freeze([1,1]);const ue=Object.freeze([0,0]);const Vh=Object.freeze([1,0]);const Uh=Object.freeze([0,1]);const xe=Object.freeze([-1/0,-1/0,-1/0]);const ye=Object.freeze([1/0,1/0,1/0]);const zb=Object.freeze([1,1,1]);const Ea=Object.freeze([0,0,0]);const Be=Object.freeze([1,0,0]);const Ce=Object.freeze([0,1,0]);const De=Object.freeze([0,0,1]);const Ee=Object.freeze([-1/0,-1/0,-1/0,-1/0]);const Fe=Object.freeze([1/0,1/0,1/0,1/0]);const Ge=Object.freeze([1,1,1,1]);const He=Object.freeze([0,0,0,0]);const Ie=Object.freeze([1,0,0,0]);const Le=Object.freeze([0,1,0,0]);const Me=Object.freeze([0,0,1,0]);const Ne=Object.freeze([0,0,0,1]);const Pe=(e,t,r,s=!0,n=!0)=>{const o=s?function(){return this.buf[this.offset+r*this.stride]}:function(){return this.buf[this.offset+r]},i=s?function(e){this.buf[this.offset+r*this.stride]=e}:function(e){this.buf[this.offset+r]=e};n&&Object.defineProperty(e,r,{get:o,set:i,enumerable:!0}),Object.defineProperty(e,t,{get:o,set:i,enumerable:!0})};const Bb=(e,t,r,s)=>t.forEach((t,n)=>Pe(e,t,n,r,s));class Eb{constructor(t,s=0,$=1){this.buf=t,this.offset=s,this.stride=$}}function*ma($,e){const r=$(gc()),f=r[1],t=r[2];for(let d of e){const $=t([],d);if(l($))return void(yield*F(f($.deref())));$.length&&(yield*$)}yield*F(f([]))}function*Ib($,e){const r=$([null,null,($,e)=>e])[2];for(let f of e){let $=r(Fa,f);if(l($))return void(($=F($.deref()))!==Fa&&(yield $));$!==Fa&&(yield $)}}const Fa=Symbol();const Xe=()=>{};var $e={};const c=void 0===$e?(r,o="assertion failed")=>{if("function"==typeof r&&!r()||!r)throw new Error(o)}:Xe;class af extends Error{constructor(r){super("illegal argument(s)"+(void 0!==r?": "+r:""))}}const bf=r=>{throw new af(r)};class cf extends Error{constructor(r){super(`illegal arity: ${r}`)}}const Ga=r=>{throw new cf(r)};class ff extends Error{constructor(t){super("illegal state"+(void 0!==t?": "+t:""))}}const gf=t=>{throw new ff(t)};class hf extends Error{constructor(r){super("unsupported operation"+(void 0!==r?": "+r:""))}}const Tb=r=>{throw new hf(r)};const kf=o=>"function"==typeof o;const Q=(n,t)=>null!=n&&"function"==typeof n[t];const mf=r=>null!=r&&"function"!=typeof r&&void 0!==r.length;const nf=e=>null!=e&&"function"==typeof e[Symbol.iterator];const u=t=>"number"==typeof t;const Vb=Object.getPrototypeOf,ga=e=>{let $;return null!=e&&"object"==typeof e&&(null===($=Vb(e))||null===Vb($))};class t{constructor(e){this.value=e}deref(){return this.value}}const wf=e=>new t(e);const l=e=>e instanceof t;const Ha=e=>e instanceof t?e:new t(e);const F=e=>e instanceof t?e.deref():e;function gc($){return $?[...$]:Y(()=>[],($,r)=>($.push(r),$))}function Ia(...e){let r,$;switch(e.length){case 3:$=e[2],r=e[1];break;case 2:$=e[1];break;default:Ga(e.length);}const t=e[0],c=t[0],o=t[1],i=t[2];if(r=null==r?c():r,Q($,"$reduce"))r=$.$reduce(i,r);else if(mf($)){for(let u=0,d=$.length;u<d;u++)if(r=i(r,$[u]),l(r)){r=r.deref();break}}else for(let u of $)if(r=i(r,u),l(r)){r=r.deref();break}return F(o(r))}const Y=(e,r)=>[e,e=>e,r];const qc=($,e,r=Ib)=>{const f=e.length-1;return nf(e[f])?e.length>1?r($.apply(null,e.slice(0,f)),e[f]):r($(),e[0]):void 0};function L(...e){let r,a;switch(e.length){case 4:a=e[3],r=e[2];break;case 3:a=e[2];break;case 2:return D(r=>L(e[0],e[1],r));default:Ga(e.length);}return Ia(e[0](e[1]),r,a)}function D(t,r){return r?Ib(D(t),r):r=>{const $=r[2];return J(r,(r,e)=>$(r,t(e)))}}const J=($,c)=>[$[0],$[1],c];function rc($){return $?Ia(rc(),$):Y(()=>new Object,($,[e,r])=>($[e]=r,$))}function tc(...e){let[r,$,t,o,c,p,i,n,s,a]=e;switch(e.length){case 0:Ga(0);case 1:return r;case 2:return(...e)=>r($(...e));case 3:return(...e)=>r($(t(...e)));case 4:return(...e)=>r($(t(o(...e))));case 5:return(...e)=>r($(t(o(c(...e)))));case 6:return(...e)=>r($(t(o(c(p(...e))))));case 7:return(...e)=>r($(t(o(c(p(i(...e)))))));case 8:return(...e)=>r($(t(o(c(p(i(n(...e))))))));case 9:return(...e)=>r($(t(o(c(p(i(n(s(...e)))))))));case 10:default:const u=(...e)=>r($(t(o(c(p(i(n(s(a(...e))))))))));return 10===e.length?u:tc(u,...e.slice(10));}}function zc(r){return r?Ia(zc(),r):Y(()=>void 0,(r,$)=>$)}function Bg(r,$){r=r||"";let e=!0;return $?[...$].join(r):Y(()=>"",($,s)=>($=e?$+s:$+r+s,e=!1,$))}const Cg=()=>r=>{const $=r[2];return J(r,(r,e)=>{if(e)for(let a of F(e))if(r=$(r,a),l(r))break;return l(e)?Ha(r):r})};function Z(e,t,r){return new Fg(e,t,r)}class Fg{constructor(e,t,r){void 0===e?(e=0,t=1/0):void 0===t&&(t=e,e=0),r=void 0===r?e<t?1:-1:r,this.from=e,this.to=t,this.step=r}*[Symbol.iterator](){const e=this.step,t=this.to;let r=this.from;if(e>0)for(;r<t;)yield r,r+=e;else if(e<0)for(;r>t;)yield r,r+=e}$reduce(e,t){const r=this.step;if(r>0)for(let o=this.from,$=this.to;o<$&&!l(t);o+=r)t=e(t,o);else for(let o=this.from,$=this.to;o>$&&!l(t);o+=r)t=e(t,o);return t}}function*Gg(...e){const t=e.map(e=>e[Symbol.iterator]());for(;;){const e=[];for(let $ of t){let t=$.next();if(t.done)return;e.push(t.value)}yield e}}const Ac=Object.getPrototypeOf({}),x=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==Ac||null!=($=Object.getPrototypeOf(t))&&$!==Ac?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Uc(e,t):e instanceof Set&&t instanceof Set?Vc(e,t):e instanceof Map&&t instanceof Map?Wc(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:Xc(e,t)))};const Uc=(e,t,$=x)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const Vc=(e,t,$=x)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const Wc=(e,t,$=x)=>e.size===t.size&&$([...e].sort(),[...t].sort());const Xc=(e,t,$=x)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};function Dc(r,t){return t?ma(Dc(r),t):t=>{const e=t[2],$=(t,o)=>{const i=r(o);if(i){for(let r of i)if(t=$(t,r),l(t))break;return t}return e(t,o)};return J(t,$)}}function Zc(t){return Dc(t=>null!=t&&t[Symbol.iterator]&&"string"!=typeof t?t:void 0,t)}function Fc(...e){return qc(Fc,e)||($=>{const r=$[2],n=e[0];let p=e[1]||0;return J($,(e,$)=>r(e,n(p++,$)))})}function ua(p,$){return $?ma(ua(p),$):Mc(D(p),Cg())}function Mc(...$){return tc.apply(null,$)}function ib(e,r){return r?ma(ib(e),r):r=>{const $=r[2];let o=e;return J(r,(e,r)=>--o>0?$(e,r):0===o?Ha($(e,r)):wf(e))}}function jb(...e){return e.length>2&&qc(jb,e,ma)||(([$,r,t])=>{const[a,n,o]=e[0];let q=e.length>1&&null!=e[1]?e[1]:a();return[$,e=>{let $=n(q);return $!==q&&(e=F(t(e,$))),q=$,r(e)},(e,$)=>(q=o(q,$),l(q)?Ha(t(e,q.deref())):t(e,q))]})}function*dd(e,$=1/0){for(;$-->0;)yield e}function*ed(r){for(let $ in r)r.hasOwnProperty($)&&(yield[$,r[$]])}const fd=$=>([o,t,p])=>`${o}=${t}${$}${p};`;const gd=$=>([o,t])=>`${o}=${t}${$}n;`;const kb=([$,o])=>`${$}*${o}`;const id=([$,o])=>`s+=${$}*${o};`;const Ja=([$,o])=>`${$}=${o};`;const kd=([$])=>`${$}=n;`;const ld=([$,o,t,p])=>`${$}=${o}+${t}*${p};`;const md=([$,o,t])=>`${$}=${o}+${t}*n;`;const nd=([$,o,t])=>`${$}=${o}+(${t}-${o})*n;`;const s=(e=0)=>{const r=new Array(5);let p;const t=(...t)=>{const o=r[t[e].length]||p;return o?o(...t):Tb(`no impl for vec size ${t[e].length}`)};return t.add=(e,p)=>r[e]=p,t.default=e=>p=e,t};const pd="o,a,b,c";const mb="o,a,b,n";const nb="io=0,ia=0,so=1,sa=1";const sd="io=0,ia=0,ib=0,so=1,sa=1,sb=1";const ob="!o&&(o=[]);";const ud=$=>o=>o>1?`${$}[i${$}+${o}*s${$}]`:1==o?`${$}[i${$}+s${$}]`:`${$}[i${$}]`,vd=$=>D(ud($),Z()),wd=$=>D(o=>`${$}[${o}]`,Z()),pb=($,o,e,t="a",p="",S="",r="",W=!1)=>[S,L(Mc(ib($),Fc(($,e)=>o(e,$))),Bg(p),Gg.apply(null,e.split(",").map(W?vd:wd))),r,null!==t?`return ${t};`:""],yd=($,o,e="a",t,p,S=!1)=>[t,"for(let i=a.length;--i>=0;) {",$(o.split(",").map(S?$=>`${$}[i${$}+i*s${$}]`:$=>`${$}[i]`)),"}",p,null!==e?`return ${e};`:""],qb=($,o)=>`!${$} && (${$}=${o.split(",")[1]});`;const y=($,o,e,t=e,p="a",S,r,W,a=!1)=>new Function(e,pb($,o,t,p,S,r,W,a).join(""));const Bd=($,o,e,t,p,S=p,r="a",W="",a,s,i=!1)=>new Function(t,`return (${p})=>{${pb($,e,S,r,W,a,s,i).join("")}}`)(...o);const oa=($,o,e=o,t="a",p,S,r=!1)=>new Function(o,yd($,e,t,p,S,r).join(""));const o=($,o="o,a,b",e,t="o",p=1,S)=>{e=e||o,S=null!=S?S:qb(t,o);const r=s(p),W=p=>r.add(p,y(p,$,o,e,t,"",S));return r.default(oa($,o,e,t,S)),[r,W(2),W(3),W(4)]};const Ed=($,o=`o,a,b,${sd}`,e="o,a,b",t="o",p,S=[2,3,4])=>S.map(S=>y(S,$,o,e,t,"",null!=p?p:qb(t,o),"",!0));const Ka=$=>o(fd($));const Gd=$=>o(gd($),"o,a,n");const sb=(e,r,$,t,o,P)=>{const f=[];for(;--$>=0;)f.push(new e(r,t,o)),t+=P;return f};const tb=(e,r,$,t,o,P)=>{for(let f of $)e(r,f,t,0,o,1),t+=P;return r};function*ub(e,r,$,t,o,P){for(;$-->0;)yield new e(r,t,o),t+=P}function*vb(e,r,$,t){for(;r-->0;)yield e[$],$+=t}const wb=Math.PI;const ka=2*wb;const Nd=wb/180;const Th=(1+Math.sqrt(5))/2;const Sh=Math.SQRT2;const Rh=Math.sqrt(3);let z=1e-6;const Na=($,t=1)=>[Math.cos($)*t,Math.sin($)*t];const Oa=Math.abs,Ud=Math.max,Cb=($,a,e=z)=>Oa($-a)<=e*Ud(1,Oa($),Oa(a));const Wd=$=>$<0?0:$>1?1:$;const Db=($,r,t)=>r+(t-r)*Wd($);const Pa=$=>ha.add($,Bd($,[Cb,z],([$,e])=>`eq(${$},${e},eps)`,"eq,_eps","a,b,eps=_eps","a,b",null,"&&","return a.length === b.length && ",";")),ha=s();ha.default(($,e,t=z)=>Q($,"eqDelta")?$.eqDelta(e,t):Q(e,"eqDelta")?e.eqDelta($,t):be($,e,$.length,t));const Qh=Pa(2);const _d=Pa(3);const ae=Pa(4);const be=($,e,t,r=z,g=0,f=0,o=1,v=1)=>{for(;t>0;t--,g+=o,f+=v)if(!Cb($[g],e[f],r))return!1;return!0};const[Ph,fa,ee]=Ed(Ja,`o,a,${nb}`,"o,a","o",ob);class a extends Eb{constructor(r,$=0,e=1){super(r||[0,0,0],$,e)}static mapBuffer(r,$=r.length/3|0,e=0,t=1,o=3){return sb($K9zr$export$Vec3,r,$,e,t,o)}static intoBuffer(r,$,e=0,t=1,o=3){return tb(fa,r,$,e,t,o)}static iterator(r,$,e=0,t=1,o=3){return ub($K9zr$export$Vec3,r,$,e,t,o)}[Symbol.iterator](){return vb(this.buf,3,this.offset,this.stride)}get length(){return 3}copy(){return new $K9zr$export$Vec3([this.x,this.y,this.z])}copyView(){return new $K9zr$export$Vec3(this.buf,this.offset,this.stride)}empty(){return new $K9zr$export$Vec3}eqDelta(r,$=z){return _d(this,r,$)}toJSON(){return[this.x,this.y,this.z]}toString(){return`[${this.x}, ${this.y}, ${this.z}]`}}a.X_AXIS=new a(Be),a.Y_AXIS=new a(Ce),a.Z_AXIS=new a(De),a.MIN=new a(xe),a.MAX=new a(ye),a.ZERO=new a(Ea),a.ONE=new a(zb),Bb(a.prototype,["x","y","z"]);class e extends Eb{constructor($,e=0,t=1){super($||[0,0,0,0],e,t)}static mapBuffer($,e=$.length>>2,t=0,r=1,l=4){return sb($Lylz$export$Vec4,$,e,t,r,l)}static intoBuffer($,e,t=0,r=1,l=4){return tb(ee,$,e,t,r,l)}static*iterator($,e,t=0,r=1,l=4){return ub($Lylz$export$Vec4,$,e,t,r,l)}[Symbol.iterator](){return vb(this.buf,4,this.offset,this.stride)}get length(){return 4}copy(){return new $Lylz$export$Vec4([this.x,this.y,this.z,this.w])}copyView(){return new $Lylz$export$Vec4(this.buf,this.offset,this.stride)}empty(){return new $Lylz$export$Vec4}eqDelta($,e=z){return ae(this,$,e)}toJSON(){return[this.x,this.y,this.z,this.w]}toString(){return`[${this.x}, ${this.y}, ${this.z}, ${this.w}]`}}e.X_AXIS=new e(Ie),e.Y_AXIS=new e(Le),e.Z_AXIS=new e(Me),e.MIN=new e(Ee),e.MAX=new e(Fe),e.ZERO=new e(He),e.ONE=new e(Ge),Bb(e.prototype,["x","y","z","w"]);const[O,Hb,Oh,Nh]=o(md,mb);const[Qa,_h,Mh,Lh]=Gd("*");const pe=($,d,i,u,c,r,o)=>O($,O($,Qa($,d,c),i,r),u,o);const qe=($,d,i,u,c,r,o,t,m)=>O($,O($,O($,Qa($,d,r),i,o),u,t),c,m);const[re,Ba,te,Kh]=Ka("+");const Lb=($,t,e,p)=>(!$&&($=[]),$[0]=t,$[1]=e,$[2]=p,$);const Mb=($,t,e,p,s)=>(!$&&($=[]),$[0]=t,$[1]=e,$[2]=p,$[3]=s,$);const Nb=($,t,e,p,s,o,r)=>(!$&&($=[]),$[0]=t,$[1]=e,$[2]=p,$[3]=s,$[4]=o,$[5]=r,$);const B=($,...t)=>{!$&&($=[]);for(let e=0,p=t.length;e<p;e++)$[e]=t[e];return $};const Pb=($,s,r)=>Lb($||s,s[1]*r[2]-s[2]*r[1],s[2]*r[0]-s[0]*r[2],s[0]*r[1]-s[1]*r[0]);const Aa=$=>Ta.add($,y($,kb,"a,b",void 0,null,"+","return ",";")),Ta=s();Ta.default(oa(id,"a,b",void 0,"s","let s=0;"));const Jh=Aa(2);const Ua=Aa(3);const Ih=Aa(4);const Va=$=>_.add($,y($,([$])=>`${$}*${$}`,"a","a",null,"+","return ",";")),_=s();_.default(oa(([$])=>`sum+=${$}*${$};`,"a",void 0,"sum","let sum=0;"));const Hh=Va(2);const Gh=Va(3);const Fh=Va(4);const Ke=$=>Math.sqrt(_($));const Zb=Math.cos,$b=Math.sin,_b=s(1);const Oe=_b.add(2,($,r,a=ue)=>Hb($||r,a,Na(r[1]),r[0]));const Eh=_b.add(3,($,r,a=Ea)=>{const e=r[0],t=r[1],s=r[2],g=Zb(t);return Lb($||r,e*g*Zb(s)+a[0],e*g*$b(s)+a[1],e*$b(t)+a[2])});const[b,Re,Dh,Ch]=o(Ja,"o,a",void 0,"o",1,ob);const Xa=$=>Q($,"copy")?$.copy():b([],$);const i=$=>$.map(Xa);const la=($,r,e=1)=>{!$&&($=r);const n=Ke(r);return n>=z?Qa($,r,e/n):$!==r?b($,r):$};const[Za,Bh,Ze,Ah]=Ka("-");const ic=([$,y])=>`t=${$}-${y};s+=t*t;`,$a=$=>N.add($,y($,ic,"a,b",void 0,"s","","let t,s=0;")),N=s();N.default(oa(ic,"a,b",void 0,"s","let t,s=0;"));const zh=$a(2);const rh=$a(3);const hh=$a(4);const nc=($,t)=>Math.sqrt(N($,t));const oc=($,o,t,C)=>$*o+t*C;const pc=($,o,t,C,r,e)=>$*o+t*C+r*e;const _a=$=>y($,kb,`o,a,${nb}`,"o,a",null,"+","return ",";",!0),p=_a(2);const r=_a(3);const d=_a(4);const[gh,fh,eh,dh]=o(kd,"a,n","a","a",0,"");const xc=e=>new Array(e).fill(0);const sf=e=>Q(e,"empty")?e.empty():xc(e.length);const[ch,uf,bh,ah]=o(ld,pd);const xf=($,r,e,i,t,o)=>{const x=1-o,c=x*x,h=o*o;return qe($,r,e,i,t,c*x,3*c*o,3*h*x,h*o)};const yf=($,r,c,t,u)=>{const a=1-u;return pe($,r,c,t,a*a,2*a*u,u*u)};const[db,_g,$g,Zg]=o(nd,mb);const[Yg,Ef,Xg,Wg]=Ka("*");const eb=(t,$)=>(r,e,o)=>{r?r!==e&&b(r,e):r=e;const a=Math.sin(o),X=Math.cos(o),Y=e[t],V=e[$];return r[t]=Y*X-V*a,r[$]=Y*a+V*X,r},Vg=eb(1,2);const Ug=eb(2,0);const Kf=eb(0,1);const Lf=Object.freeze([1,0,0,1]);const Mf=Object.freeze([1,0,0,1,0,0]);const Nf=Object.freeze([1,0,0,0,1,0,0,0,1]);const Of=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);const E=s(1);const Tg=E.add(4,($,t,o)=>Mb($||t,p(t,o,0,0,2),p(t,o,1,0,2),p(t,o,0,2,2),p(t,o,1,2,2)));const Sg=E.add(6,($,t,o)=>Nb($||t,p(t,o,0,0,2),p(t,o,1,0,2),p(t,o,0,2,2),p(t,o,1,2,2),p(t,o,0,4,2)+t[4],p(t,o,1,4,2)+t[5]));const Rg=E.add(9,($,t,o)=>B($||t,r(t,o,0,0,3),r(t,o,1,0,3),r(t,o,2,0,3),r(t,o,0,3,3),r(t,o,1,3,3),r(t,o,2,3,3),r(t,o,0,6,3),r(t,o,1,6,3),r(t,o,2,6,3)));const Qg=E.add(16,($,t,o)=>B($||t,d(t,o,0,0,4),d(t,o,1,0,4),d(t,o,2,0,4),d(t,o,3,0,4),d(t,o,0,4,4),d(t,o,1,4,4),d(t,o,2,4,4),d(t,o,3,4,4),d(t,o,0,8,4),d(t,o,1,8,4),d(t,o,2,8,4),d(t,o,3,8,4),d(t,o,0,12,4),d(t,o,1,12,4),d(t,o,2,12,4),d(t,o,3,12,4)));const h=oc,Gc=pc;const Wf=$=>{const[t,r,e,o,p,y,L,S,T,d,s,a,v,x,f,n]=$;return[h(t,y,-r,p),h(t,L,-e,p),h(t,S,-o,p),h(r,L,-e,y),h(r,S,-o,y),h(e,S,-o,L),h(T,x,-d,v),h(T,f,-s,v),h(T,n,-a,v),h(d,f,-s,x),h(d,n,-a,x),h(s,n,-a,f)]};const Xf=$=>Gc($[0],$[11],-$[1],$[10],$[2],$[9])+Gc($[3],$[8],-$[4],$[7],$[5],$[6]);const Yf=(t,o,r,$,C,e,u)=>{const s=1/(r-o),n=1/(C-$),p=1/(u-e);return B(t||[],2*e*s,0,0,0,0,2*e*n,0,0,(r+o)*s,(C+$)*n,-(u+e)*p,-1,0,0,-u*e*2*p,0)};const Zf=(t,o,r,$)=>{const C=r*Math.tan(t*Nd/2),e=C*o;return{left:-e,right:e,bottom:-C,top:C,near:r,far:$}};const gb=$=>b.add($,y($,Ja,"o,a")),wa=b;const Pg=gb(6);const Og=gb(9);const Mg=gb(16);const ta=s();const Lg=ta.add(4,$=>wa($,Lf));const Kg=ta.add(6,$=>wa($,Mf));const gg=ta.add(9,$=>wa($,Nf));const K=ta.add(16,$=>wa($,Of));const f=oc,A=pc,ba=s(1);const Jg=ba.add(4,($,e)=>{const[p,r,t,C]=e;let O=f(p,C,-r,t);if(0!==O)return O=1/O,Mb($||e,C*O,-r*O,-t*O,p*O)});const qh=ba.add(6,($,e)=>{const[p,r,t,C,O,v]=e;let o=f(p,C,-r,t);if(0!==o)return o=1/o,Nb($||e,C*o,-r*o,-t*o,p*o,f(t,v,-C,O)*o,f(r,O,-p,v)*o)});const ng=ba.add(9,($,e)=>{const[p,r,t,C,O,v,o,d,n]=e,a=f(n,O,-v,d),i=f(v,o,-n,C),s=f(d,C,-O,o);let x=A(p,a,r,i,t,s);if(0!==x)return x=1/x,B($||e,a*x,f(-n,r,t,d)*x,f(v,r,-t,O)*x,i*x,f(n,p,-t,o)*x,f(-v,p,t,C)*x,s*x,f(-d,p,r,o)*x,f(O,p,-r,C)*x)});const Ig=ba.add(16,($,e)=>{const p=Wf(e);let r=Xf(p);if(0===r)return;r=1/r;const[t,C,O,v,o,d,n,a,i,s,x,c,m,f,u,l]=e,[q,Q,g,h,F,S,b,j,k,w,y,z]=p;return B($||e,A(d,z,-n,y,a,w)*r,A(-C,z,O,y,-v,w)*r,A(f,S,-u,F,l,h)*r,A(-s,S,x,F,-c,h)*r,A(-o,z,n,k,-a,j)*r,A(t,z,-O,k,v,j)*r,A(-m,S,u,g,-l,Q)*r,A(i,S,-x,g,c,Q)*r,A(o,y,-d,k,a,b)*r,A(-t,y,C,k,-v,b)*r,A(m,F,-f,g,l,q)*r,A(-i,F,s,g,-c,q)*r,A(-o,w,d,j,-n,b)*r,A(t,w,-C,j,O,b)*r,A(-m,h,f,Q,-u,q)*r,A(i,h,-s,Q,x,q)*r)});const pg=($,r,o,i)=>{const t=la(null,Ze([],r,o)),p=la(null,Pb([],i,t)),O=la(null,Pb([],t,p));return B($||[],p[0],O[0],t[0],0,p[1],O[1],t[1],0,p[2],O[2],t[2],0,-Ua(r,p),-Ua(r,O),-Ua(r,t),1)};const qg=($,r)=>(!$&&($=[]),fa($,r),fa($,r,3,4),fa($,r,6,8));const rg=(t,$)=>B(t||[],$[0],$[3],$[6],$[1],$[4],$[7],$[2],$[5],$[8]);const sg=($,r)=>rg(null,ng(null,qg($,r)));const tg=(r,$,o,t,e,h,v)=>{const p=1/(o-$),s=1/(e-t),A=1/(v-h);return B(r||[],2*p,0,0,0,0,2*s,0,0,0,0,-2*A,0,-($+o)*p,-(e+t)*s,-(v+h)*A,1)};const ug=(r,t,e,$,p)=>{const f=Zf(t,e,$,p);return Yf(r,f.left,f.right,f.bottom,f.top,f.near,f.far)};const vg=(t,$,D=Ea)=>{const[r,o,e,T]=$,a=r+r,p=o+o,P=e+e,s=r*a,u=r*p,c=r*P,i=o*p,n=o*P,q=e*P,x=T*a,M=T*p,m=T*P;return B(t||[],1-i-q,u+m,c-M,0,u-m,1-s-q,n+x,0,c+M,n-x,1-s-i,0,D[0],D[1],D[2],1)};const wg=($,e)=>(e=u(e)?[e,e,e]:e,B($||[],e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,void 0!==e[3]?e[3]:1));class hb{constructor(){this._position=new a,this._rotation=new e(Xa(Ne)),this._scale=new a(Xa(zb)),this._model=[],this._modelDirty=!0,this._rt=[],this.modelView=[],this.normal=[],this.children=[],K(this.modelView),gg(this.normal),K(this._model),K(this._rt)}set position(t){b(this._position,t),this._modelDirty=!0}get position(){return this._position}set rotation(t){this._rotation=t,this._modelDirty=!0}get rotation(){return this._rotation}set scale(t){b(this._scale,t),this._modelDirty=!0}get scale(){return this._scale}get model(){return this._modelDirty&&(E(this._model,vg(this._rt,this.rotation,this.position),wg(this._model,this.scale)),this._modelDirty=!1),this._model}updateMatrices(t){E(this.modelView,t,this.model),sg(this.normal,this.modelView)}add(t){t.parent=this,this.children.push(t)}}class yg extends hb{}class zg extends hb{constructor(s,t,$=4){super(),this.attribPool=s,this.material=t,this.type=$,this.attribs=L(D(([t,{size:$}])=>[t,{numComponents:$,data:[...Zc(s.attribValues(t))]}]),rc(),ed(s.specs))}}var Ag={},Nc="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(Nc){var Oc=new Uint8Array(16);Ag=function(){return Nc(Oc),Oc}}else{var Pc=new Array(16);Ag=function(){for(var r,o=0;o<16;o++)0==(3&o)&&(r=4294967296*Math.random()),Pc[o]=r>>>((3&o)<<3)&255;return Pc}}for(var Eg={},Qc=[],$=0;$<256;++$)Qc[$]=($+256).toString(16).substr(1);function og($,r){var s=r||0,p=Qc;return[p[$[s++]],p[$[s++]],p[$[s++]],p[$[s++]],"-",p[$[s++]],p[$[s++]],"-",p[$[s++]],p[$[s++]],"-",p[$[s++]],p[$[s++]],"-",p[$[s++]],p[$[s++]],p[$[s++]],p[$[s++]],p[$[s++]],p[$[s++]]].join("")}Eg=og;var mg={};function lg(r,$,a){var e=$&&a||0;"string"==typeof r&&($="binary"===r?new Array(16):null,r=null);var n=(r=r||{}).random||(r.rng||Ag)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,$)for(var U=0;U<16;++U)$[e+U]=n[U];return $||Eg(n)}mg=lg;class fg{constructor(t,r,$={}){var $UO$$interop$default=aa(mg);this.vert=t,this.frag=r,this.uniforms=$,this.id=$UO$$interop$default.d()}}class eg{constructor(r,t){this.gl=r,this.programInfos={},this.objects=[],t.children.forEach(t=>{const o=t,a=this.getProgram(o.material),e=g.createBufferInfoFromArrays(r,o.attribs),s=g.createVertexArrayInfo(r,a,e);this.objects.push({programInfo:a,vertexArrayInfo:s,mesh:o,type:o.type,uniforms:{}})})}draw(r,t=null){const o=this.gl;o.viewport(0,0,r.width,r.height),g.bindFramebufferInfo(o,t),this.objects.forEach(t=>{const{mesh:o}=t;o.updateMatrices(r.view),t.uniforms=Object.assign({},o.material.uniforms,{matModel:o.model,matView:r.view,matProj:r.projection,matModelView:o.modelView,matNormal:o.normal})}),g.drawObjectList(o,this.objects)}getProgram({id:r,vert:t,frag:o}){return this.programInfos[r]||(this.programInfos[r]=g.createProgramInfo(this.gl,[t,o])),this.programInfos[r]}}class Ic extends hb{constructor(t,e){super(),this._view=[],this._projection=[],this.width=t,this.height=e,K(this._view),K(this._projection)}set width(t){this._width=t}get width(){return this._width}set height(t){this._height=t}get height(){return this._height}get projection(){return this._projection}get view(){return this._view}}class Ng extends Ic{constructor(){super(...arguments),this._fov=30,this._near=.01,this._far=1e3,this._projectionCached=!1,this._target=new a,this._up=new a([0,1,0]),this._viewCached=!1}set width(t){this._width=t,this._projectionCached=!1}get width(){return this._width}set height(t){this._height=t,this._projectionCached=!1}get height(){return this._height}set fov(t){this._fov=t,this._projectionCached=!1}get fov(){return this._fov}get aspect(){return this.width/this.height}set near(t){this._near=t,this._projectionCached=!1}get near(){return this._near}set far(t){this._far=t,this._projectionCached=!1}get far(){return this._far}set position(t){t.eqDelta(this._position)||(b(this._position,t),this._viewCached=!1,this._modelDirty=!0)}get position(){return this._position}set target(t){t.eqDelta(this._target)||(b(this._target,t),this._viewCached=!1)}get target(){return this._target}set up(t){t.eqDelta(this._up)||(b(this._up,t),this._viewCached=!1)}get up(){return this._up}get pivotDistance(){return nc(this.target,this.position)}get projection(){return this._projectionCached||(ug(this._projection,this.fov,this.aspect,this.near,this.far),this._projectionCached=!0),this._projection}get view(){return this._viewCached||(pg(this._view,this.position,this.target,this.up),this._viewCached=!0),this._view}}class bg extends Ic{constructor(){super(...arguments),this.left=-1,this.right=1,this.top=1,this.bottom=-1,this.near=0,this.far=1e3,this._projectionCached=!1}get projection(){return this._projectionCached||(tg(this._projection,this.left,this.right,this.bottom,this.top,this.near,this.far),this._projectionCached=!0),this._projection}}var ag,Tf;(function($){$[$.U8=0]="U8",$[$.U8C=1]="U8C",$[$.I8=2]="I8",$[$.U16=3]="U16",$[$.I16=4]="I16",$[$.U32=5]="U32",$[$.I32=6]="I32",$[$.F32=7]="F32",$[$.F64=8]="F64"})(Tf||(ag=Tf={},ag));const I={0:1,1:1,2:1,3:2,4:2,5:4,6:4,7:4,8:8};const G=($,d)=>(d--,$+d&~d);const Qf={0:(r,a,n)=>new Uint8Array(r,a,n),1:(r,a,n)=>new Uint8ClampedArray(r,a,n),2:(r,a,n)=>new Int8Array(r,a,n),3:(r,a,n)=>new Uint16Array(r,a,n),4:(r,a,n)=>new Int16Array(r,a,n),5:(r,a,n)=>new Uint32Array(r,a,n),6:(r,a,n)=>new Int32Array(r,a,n),7:(r,a,n)=>new Float32Array(r,a,n),8:(r,a,n)=>new Float64Array(r,a,n)},ea=(r,a,n,$)=>Qf[r](a,n,$);class Ec{constructor(t={}){this.buf=t.buf?t.buf:new ArrayBuffer(t.size),this.u8=new Uint8Array(this.buf),this.start=null!=t.start?G(Math.max(t.start,8),8):8,this.end=null!=t.end?Math.min(t.end,this.buf.byteLength):this.buf.byteLength,this.start>=this.end&&bf(`invalid address range (0x${this.start.toString(16)} - 0x${this.end.toString(16)})`),this.top=this.start,this.doCompact=!1!==t.compact,this.doSplit=!1!==t.split,this.minSplit=t.minSplit||16,this._free=null,this._used=null}stats(){const t=t=>{let e=0,i=0;for(;t;)e++,i+=t.size,t=t.next;return{count:e,size:i}},e=t(this._free);return{free:e,used:t(this._used),top:this.top,available:this.end-this.top+e.size,total:this.buf.byteLength}}callocAs(t,e){const i=this.mallocAs(t,e);return i&&i.fill(0),i}mallocAs(t,e){const i=this.malloc(e*I[t]);return i?ea(t,this.buf,i,e):null}calloc(t){const e=this.malloc(t);return e&&this.u8.fill(0,e,G(e+t,8)),e}malloc(t){if(t<=0)return 0;t=G(t,8);let e=this.top;const i=this.end;let s=this._free,r=null;for(;s;){const n=s.addr+s.size>=e;if(n||s.size>=t){if(n&&s.addr+t>i)return 0;if(r?r.next=s.next:this._free=s.next,s.next=this._used,this._used=s,n)s.size=t,this.top=s.addr+t;else if(this.doSplit){const e=s.size-t;e>=this.minSplit&&(s.size=t,this.insert({addr:s.addr+t,size:e,next:null}),this.doCompact&&this.compact())}return s.addr}r=s,s=s.next}const n=G(e,8);return(e=n+t)<=i?(s={addr:n,size:t,next:this._used},this._used=s,this.top=e,n):0}realloc(t,e){if(e<=0)return 0;e=G(e,8);let i,s=this._used,r=0;for(;s;){if(s.addr===t){const n=(i=t+s.size)>=this.top;if(e<=s.size){if(this.doSplit){const i=s.size-e;i>=this.minSplit?(s.size=e,this.insert({addr:s.addr+e,size:i,next:null}),this.doCompact&&this.compact()):n&&(this.top=t+e)}else n&&(this.top=t+e);r=t;break}if(n&&t+e<this.end){s.size=e,this.top=t+e,r=t;break}this.free(t),r=this.malloc(e);break}s=s.next}return r&&r!==t&&this.u8.copyWithin(r,t,i),r}reallocArray(t,e){if(t.buffer!==this.buf)return null;const i=this.realloc(t.byteOffset,e*t.BYTES_PER_ELEMENT);return i?new t.constructor(this.buf,i,e):null}free(t){let e;if(u(t))e=t;else{if(t.buffer!==this.buf)return!1;e=t.byteOffset}let i=this._used,s=null;for(;i;){if(i.addr===e)return s?s.next=i.next:this._used=i.next,this.insert(i),this.doCompact&&this.compact(),!0;s=i,i=i.next}return!1}freeAll(){this._free=null,this._used=null,this.top=this.start}release(){return delete this._free,delete this._used,delete this.u8,delete this.buf,delete this.top,delete this.start,delete this.end,!0}compact(){let t,e,i,s=this._free,r=!1;for(;s;){for(i=s,e=s.next;e&&i.addr+i.size===e.addr;)i=e,e=e.next;if(i!==s){const t=i.addr-s.addr+i.size;s.size=t;const e=i.next;let n=s.next;for(;n!==i.next;){const t=n.next;n.next=null,n=t}s.next=e,r=!0}s.addr+s.size>=this.top&&(this.top=s.addr,t?t.next=s.next:this._free=s.next),t=s,s=s.next}return r}insert(t){let e=this._free,i=null;for(;e&&!(t.addr<=e.addr);)i=e,e=e.next;i?i.next=t:this._free=t,t.next=e}}var Gf,Ff;(function($){$[$.I8=5120]="I8",$[$.U8=5121]="U8",$[$.I16=5122]="I16",$[$.U16=5123]="U16",$[$.I32=5124]="I32",$[$.U32=5125]="U32",$[$.F32=5126]="F32"})(Ff||(Gf=Ff={},Gf));const Cc={5120:2,5121:0,5122:4,5123:3,5124:6,5124:6,5125:5,5126:7};const P=$=>{const e=Cc[$];return void 0!==e?e:$};class Bf{constructor(t){t=Object.assign({resizable:!0},t),this.pool=t.mem instanceof Ec?t.mem:new Ec(t.mem),this.capacity=t.num,this.resizable=t.resizable,this.specs={},this.attribs={},this.order=[],this.byteStride=1,this.maxAttribSize=1,t.attribs&&this.addAttribs(t.attribs,!0)}bytes(){return new Uint8Array(this.pool.buf,this.addr,this.capacity*this.byteStride)}release(t=!0){return t&&this.pool&&this.pool.release(),delete this.pool,delete this.attribs,delete this.specs,!0}addAttribs(t,e=!1){const[i,s]=this.computeStride(t);if(this.maxAttribSize=s,i!=this.byteStride&&this.realign(i),this.validateSpecs(t,i),this.byteStride=i,e){const t=this.pool.malloc(this.capacity*this.byteStride);c(t>0,"out of memory"),this.addr=t}this.initDefaults(t)}attribValue(t,e){const i=this.specs[t];if(c(!!i,`invalid attrib: ${t}`),!(e>=this.capacity))return e*=i.stride,i.size>1?this.attribs[t].subarray(e,e+i.size):this.attribs[t][e]}*attribValues(t){const e=this.attribs[t];c(!!e,`invalid attrib: ${t}`);const i=this.specs[t],s=i.stride,r=i.size;if(r>1)for(let a=0,o=0,p=this.capacity;a<p;a++,o+=s)yield e.subarray(o,o+r);else for(let a=0,o=this.capacity;a<o;a++)yield e[a*s]}setAttribValue(t,e,i){const s=this.specs[t];c(!!s,`invalid attrib: ${t}`),this.ensure(e+1);const r=this.attribs[t];e*=s.stride;const a="number"==typeof i;return c(()=>!a&&s.size>1||a&&1===s.size,`incompatible value for attrib: ${t}`),a?r[e]=i:(c(i.length<=s.size,`wrong attrib val size, expected ${s.size}, got ${i.length}`),r.set(i,e)),this}setAttribValues(t,e){const i=this.specs[t];c(!!i,`invalid attrib: ${t}`);const s=e.length,r=e[0],a=i.stride;this.ensure(s);const o=this.attribs[t],p="number"==typeof r;if(c(()=>!p&&i.size>1||p&&1===i.size,`incompatible value(s) for attrib: ${t}`),p)for(let h=0;h<s;h++)o[h*a]=e[h];else{c(r.length<=i.size,`wrong attrib val size, expected ${i.size}, got ${r.length}`);for(let t=0;t<s;t++)o.set(e[t],t*a)}}removeAttrib(t){if(!this.attribs[t])return!1;delete this.attribs[t],delete this.specs[t],this.updateOrder();const[e,i]=this.computeStride(this.specs,!1);this.maxAttribSize=i,this.realign(e)}ensure(t,e=!1){if(t<=this.capacity)return;c(this.resizable,"pool resizing disabled");const i=this.pool.realloc(this.addr,t*this.byteStride);c(i>0,"out of memory");for(let s in this.specs){const e=this.specs[s],r=ea(P(e.type),this.pool.buf,i+(e.byteOffset||0),(t-1)*e.stride+e.size);r.set(this.attribs[s]),this.attribs[s]=r}e&&this.setDefaults(this.specs,this.capacity,t),this.addr=i,this.capacity=t}computeStride(t,e=!0){let i=e?this.byteStride:1,s=e?this.maxAttribSize:1;for(let r in t){const e=t[r],a=I[P(e.type)];s=Math.max(s,a),i=Math.max(i,e.byteOffset+e.size*a)}return[G(i,s),s]}validateSpecs(t,e=this.byteStride){for(let i in t){c(!this.attribs[i],`attrib: ${i} already exists`);const s=t[i];c(s.size>0,`attrib ${i}: illegal or missing size`);const r=I[P(s.type)];null==s.default&&(s.default=s.size>1?xc(s.size):0);const a="number"==typeof s.default;c(()=>!a&&s.size===s.default.length||a&&1===s.size,`attrib ${i}: incompatible default value, expected size ${s.size}`),c(s.byteOffset%r==0,`attrib ${i}: invalid offset, expected multiple of ${r}`),s.stride=e/r,this.specs[i]=s}this.updateOrder()}updateOrder(){this.order=Object.keys(this.specs).sort((t,e)=>this.specs[t].byteOffset-this.specs[e].byteOffset)}initDefaults(t,e=0,i=this.capacity){for(let s in t){const e=t[s];this.attribs[s]=ea(P(e.type),this.pool.buf,this.addr+(e.byteOffset||0),(this.capacity-1)*e.stride+e.size)}this.setDefaults(t,e,i)}setDefaults(t,e=0,i=this.capacity){for(let s in t){const r=t[s];if(null==r.default)continue;const a=this.attribs[s],o=r.stride,p=r.default;if("number"==typeof p)for(let t=e;t<i;t++)a[t*o]=p;else for(let t=e;t<i;t++)a.set(p,t*o)}}realign(t){if(0===this.order.length||t===this.byteStride)return;console.warn(`realigning ${this.byteStride} -> ${t}...`);const e=t>this.byteStride;let i=this.addr;if(e)c(this.resizable,"pool resizing disabled"),i=this.pool.realloc(this.addr,this.capacity*t),c(i>0,"out of memory");else if(!this.resizable)return;const s=i===this.addr,r=this.capacity-1,a=this.attribs,o={},p=this.specs,h=e?[...this.order].reverse():this.order;for(let $ in p){const e=p[$],s=P(e.type),a=t/I[s];o[$]=[ea(s,this.pool.buf,i+e.byteOffset,r*a+e.size),a]}for(let $ of t<this.byteStride?Z(r+1):Z(r,-1,-1))for(let t of h){const i=p[t],r=i.stride,h=a[t],[l,c]=o[t];if("number"==typeof i.default)l[$*c]=h[$*r];else{const t=$*r;s?(e?l:h).copyWithin($*c,t,t+i.size):l.set(h.subarray(t,t+i.size),$*c)}}this.addr=i,this.byteStride=t;for(let $ in o){const t=o[$];a[$]=t[0],p[$].stride=t[1]}}}const Af=(t,$,o,p,r,e,i=[])=>cb(t,$,o,Db(e,p,r),i);const cb=(t,$,o,p,r=[])=>Ba(null,Kf(null,Ef(r,Na(p),$),o),t);let q=20;const yc=(t,$,o)=>{const e=Za([],o,$),s=_(e);return s>1e-6?Ta(Za([],t,$),e)/s:void 0};const wc=(t,$,o,e,s=!1,r=0)=>{const g=yc(t,$,o);if(void 0!==g&&(!s||g>=r&&g<=1-r))return e=e||sf(t),g<=0?b(e,$):g>=1?b(e,o):db(e,$,o,g)};class ja{constructor(t,i=!1){i?(this.points=t.slice(),this.points.push(t[0])):this.points=t,this.buildIndex()}totalLength(){return this.index[this.index.length-1]}pointAt(t){const i=this.points,s=i.length-1;if(s<0)return;if(0===s||t<=0)return i[0];if(t>=1)return i[s];const e=this.index,n=t*e[s];for(let r=1;r<=s;r++)if(e[r]>=n)return db([],i[r-1],i[r],(n-e[r-1])/(e[r]-e[r-1]))}closestPoint(t){const i=this.points,s=[],e=[];let n=1/0;for(let r=0,o=i.length-1;r<o;r++)if(wc(t,i[r],i[r+1],s)){const i=N(t,s);i<n&&(n=i,b(e,s))}return e}closestT(t){const i=this.points,s=this.index,e=[],n=[];let r,o=1/0;for(let $=0,h=s.length-1;$<h;$++)if(wc(t,i[$],i[$+1],e)){const i=N(t,e);i<o&&(o=i,r=$,b(n,e))}return Db(yc(t,i[r],i[r+1]),s[r],s[r+1])/this.totalLength()}segmentAt(t){let i=this.indexAt(t);if(void 0!==i)return i=Math.max(1,i),[this.points[i-1],this.points[i]]}tangentAt(t,i=1){const s=this.segmentAt(t);return s?la(null,Za([],s[1],s[0]),i):void 0}splitAt(t){if(t<=0||t>=1)return[this.points];const i=this.pointAt(t),s=Math.max(1,this.indexAt(t)),e=this.points.slice(0,s),n=this.points.slice(s);return ha(e[s-1],i)||e.push(i),ha(n[0],i)||n.unshift(i),[e,n]}splitNear(t){return this.splitAt(this.closestT(t))}indexAt(t){const i=this.points.length-1;if(i<0)return;if(0===i||t<=0)return 0;if(t>=1)return i;const s=this.index,e=t*s[i];for(let n=1;n<=i;n++)if(s[n]>=e)return n}sampleUniform(t,i=!1,s=[]){const e=this.index,n=this.points,r=this.totalLength(),o=t/r,$=e.length;for(let h=0,p=1;h<1;h+=o){const t=h*r;for(;t>=e[p]&&p<$;)p++;if(p>=$)break;const i=e[p-1];s.push(db([],n[p-1],n[p],(t-i)/(e[p]-i)))}return i&&s.push(b([],n[n.length-1])),s}sampleFixedNum(t,i=!1,s){return this.sampleUniform(this.totalLength()/t,i,s)}buildIndex(){const t=[0],i=this.points,s=i.length;for(let e=0,n=1;n<s;e=n,n++)t[n]=t[e]+nc(i[e],i[n]);this.index=t}}const vc=(e,r,$=!1,t=!1)=>{if(void 0!==r){const t=new ja(e,$);return ga(r)?$?r.dist?t.sampleUniform(r.dist,r.last):t.sampleFixedNum(r.num,r.last):r.dist?t.sampleUniform(r.dist,!1!==r.last):t.sampleFixedNum(r.num,!1!==r.last):t.sampleFixedNum(r||q,!$)}return t?i(e):e};const uc=(e,$,t,r,i,p)=>{if(ga(p)&&void 0!==p.dist)return new ja(uc(e,$,t,r,i,p.num||q)).sampleUniform(p.dist,!1!==p.last);let a=i-r,h=(p=u(p)?{num:p,last:!0}:Object.assign({num:q},p)).theta?Math.round(a/p.theta):p.num;a/=h,!1!==p.last&&h++;const m=new Array(h);for(let o=0;o<h;o++)m[o]=cb(e,$,t,r+o*a);return m};class m{constructor(t,s){this.points=t,this.attribs=s}*[Symbol.iterator](){yield*this.points}}class ih{constructor(t=[0,0,0],s=[1,1,1],r){this.pos=t,this.size=s,this.attribs=r}get type(){return 1}copy(){return new $uYqO$export$AABB(b([],this.pos),b([],this.size),Object.assign({},this.attribs))}max(){return te([],this.pos,this.size)}}class jh{constructor(t,s,r,i,e,$=!1,o=!1,p){this.pos=t,this.r=s,this.axis=r,this.start=i,this.end=e,this.xl=$,this.cw=o,this.attribs=p}get type(){return 2}copy(){return new $uYqO$export$Arc(b([],this.pos),b([],this.r),this.axis,this.start,this.end,this.xl,this.cw,Object.assign({},this.attribs))}equiv(t){return t instanceof $uYqO$export$Arc&&x(this.pos,t.pos)&&x(this.r,t.r)&&this.start===t.start&&this.end===t.end&&this.axis===t.axis&&this.xl===t.xl&&this.cw&&t.cw}pointAt(t,s=[]){return Af(this.pos,this.r,this.axis,this.start,this.end,t,s)}pointAtTheta(t,s=[]){return cb(this.pos,this.r,this.axis,t,s)}toHiccup(){return["path",this.attribs,[["M",this.pointAt(0)],...this.toHiccupPathSegments()]]}toHiccupPathSegments(){return[["A",this.r[0],this.r[1],this.axis,this.xl,this.cw,this.pointAt(1)]]}}class kh{constructor(t=[0,0],s=1,r){this.pos=t,this.r=s,this.attribs=r}get type(){return 3}copy(){return new $uYqO$export$Circle(b([],this.pos),this.r,Object.assign({},this.attribs))}toHiccup(){return["circle",this.attribs,this.pos,this.r]}}class lh extends m{get type(){return 4}copy(){return new $uYqO$export$Cubic(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["path",this.attribs,[["M",this.points[0]],...this.toHiccupPathSegments()]]}toHiccupPathSegments(){const t=this.points;return[["C",t[1],t[2],t[3]]]}}class mh{constructor(t=[0,0],s=[1,1],r){this.pos=t,this.r=u(s)?[s,s]:s,this.attribs=r}get type(){return 6}copy(){return new $uYqO$export$Ellipse(b([],this.pos),b([],this.r),Object.assign({},this.attribs))}toHiccup(){return["ellipse",this.attribs,this.pos,this.r]}}class nh{constructor(t,s){this.attribs=t,this.children=s||[]}get type(){return 7}*[Symbol.iterator](){yield*this.children}copy(){return new $uYqO$export$Group(Object.assign({},this.attribs),this.children.map(t=>t.copy()))}equiv(t){return t instanceof $uYqO$export$Group&&x(this.children,t.children)}toHiccup(){return["g",this.attribs,...this.children.map(t=>t.toHiccup())]}}class oh extends m{get type(){return 8}copy(){return new $uYqO$export$Line(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["line",this.attribs,this.points[0],this.points[1]]}toHiccupPathSegments(){const[t,s]=this.points;return[t[0]===s[0]?["V",s[1]]:t[1]===s[1]?["H",s[0]]:["L",s]]}}class ph{constructor(t,s){this.segments=t||[],this.attribs=s,this.closed=!1}get type(){return 10}*[Symbol.iterator](){yield*this.segments}copy(){const t=new $uYqO$export$Path([...this.segments],Object.assign({},this.attribs));return t.closed=this.closed,t}equiv(t){return t instanceof $uYqO$export$Path&&x(this.segments,t.segments)}add(t){this.closed&&gf("path already closed"),this.segments.push(t)}toHiccup(){let t=[];const s=this.segments,r=s.length;if(r>1){t.push(["M",s[0].point]);for(let i=1;i<r;i++)t=t.concat(s[i].geo.toHiccupPathSegments());this.closed&&t.push(["Z"])}return["path",this.attribs||{},t]}}class Hg extends m{get type(){return 11}copy(){return new $uYqO$export$Points(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["points",this.attribs,this.points]}}class df extends m{get type(){return 13}copy(){return new $uYqO$export$Polygon(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["polygon",this.attribs,this.points]}}class sh extends m{get type(){return 15}copy(){return new $uYqO$export$Polyline(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["polyline",Object.assign({},this.attribs,{fill:"none"}),this.points]}toHiccupPathSegments(){const t=[];for(let s=this.points,r=s.length,i=1;i<r;i++)t.push(["L",s[i]]);return t}}class th extends m{get type(){return 17}copy(){return new $uYqO$export$Quad(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["polygon",this.attribs,this.points]}}class uh extends m{get type(){return 19}copy(){return new $uYqO$export$Quadratic(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["path",this.attribs,[["M",this.points[0]],...this.toHiccupPathSegments()]]}toHiccupPathSegments(){const t=this.points;return[["Q",t[1],t[2]]]}}class vh{constructor(t,s,r){this.pos=t,this.dir=s,this.attribs=r}get type(){return 25}copy(){return new $uYqO$export$Ray(b([],this.pos),b([],this.dir),Object.assign({},this.attribs))}toHiccup(){return["line",this.attribs,this.pos,Hb([],this.pos,this.dir,1e6)]}}class wh{constructor(t=[0,0],s=[1,1],r){this.pos=t,this.size=u(s)?[s,s]:s,this.attribs=r}get type(){return 21}copy(){return new $uYqO$export$Rect(b([],this.pos),b([],this.size),Object.assign({},this.attribs))}max(){return Ba([],this.pos,this.size)}toHiccup(){return["rect",this.attribs,this.pos,this.size[0],this.size[1]]}}class xh{constructor(t=[0,0,0],s=1,r){this.pos=t,this.r=s,this.attribs=r}get type(){return 22}copy(){return new $uYqO$export$Sphere(b([],this.pos),this.r,Object.assign({},this.attribs))}toHiccup(){return["sphere",this.attribs,this.pos,this.r]}}class yh extends m{get type(){return 23}copy(){return new $uYqO$export$Triangle(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["polygon",this.attribs,this.points]}}const lc=($,e)=>{if(ga(e)&&void 0!==e.dist)return new ja(lc($,e.num||q)).sampleUniform(e.dist,!1!==e.last);e=u(e)?{num:e,last:!0}:Object.assign({num:q},e);const o=[],[r,n,i,t]=$,p=1/e.num;for(let m=0;m<e.num;m++)o.push(xf([],r,n,i,t,m*p));return e.last&&o.push(b([],t)),o};const hc=($,r)=>{if(ga(r)&&void 0!==r.dist)return new ja(hc($,r.num||q)).sampleUniform(r.dist,!1!==r.last);const e=[],i=1/(r=u(r)?{num:r,last:!0}:Object.assign({num:q},r)).num,[t,a,p]=$;for(let m=0;m<r.num;m++)e.push(yf([],t,a,p,m*i));return r.last&&e.push(b([],p)),e};const S=Symbol();function T(p,e){const t={},$=e?Je(e):{},r=(...e)=>{const r=p(...e),f=t[r]||ia(t,$,r)||t[S];return f?f(...e):Tb(`missing implementation for: "${r.toString()}"`)};return r.add=(p,e)=>!t[p]&&(t[p]=e,!0),r.addAll=p=>{let e=!0;for(let t in p)e=r.add(t,p[t])&&e;return e},r.remove=p=>!!t[p]&&(delete t[p],!0),r.callable=(...e)=>{const r=p(...e);return!!(t[r]||ia(t,$,r)||t[S])},r.isa=(p,e)=>{let t=$[p];!t&&($[p]=t=new Set),t.add(e)},r.impls=()=>{const p=new Set(Object.keys(t));for(let e in $)ia(t,$,e)&&p.add(e);return t[S]&&p.add(S),p},r.rels=()=>$,r.parents=p=>$[p],r.ancestors=p=>new Set(ac([],$,p)),r}const ia=(p,e,t)=>{const $=e[t];if($)for(let r of $){let t=p[r]||ia(p,e,r);if(t)return t}},ac=(p,e,t)=>{const $=e[t];if($)for(let r of $)p.push(r),ac(p,e,r);return p},Je=p=>{const e={};for(let t in p){const $=p[t];e[t]=$ instanceof Set?$:new Set($)}return e};const X=i=>i.type;const k=T(X);k.addAll({2:($,r)=>uc($.pos,$.r,$.axis,$.start,$.end,r),3:($,r=q)=>{const e=$.pos,t=$.r;let[i,o]=Ub(r,t);const s=ka/i;o&&i++;const p=new Array(i);for(let c=0;c<i;c++)p[c]=Oe(null,[t,c*s],e);return p},4:($,r)=>lc($.points,r),6:($,r=q)=>{const e=[],t=$.pos,i=$.r;let[o,s]=Ub(r,Math.max($.r[0],$.r[1]));const p=ka/o;s&&o++;for(let c=0;c<o;c++)e[c]=uf([],t,Na(c*p),i);return e},7:({children:$})=>$.reduce(($,r)=>$.concat(k(r)),[]),10:($,r)=>{const e=u(r)?{num:r}:r;let t=[];for(let i=$.segments,o=i.length-1,s=0;s<=o;s++){const r=i[s];r.geo&&(t=t.concat(k(r.geo,Object.assign({},e,{last:s===o&&!$.closed}))))}return t},11:$=>$.points,13:($,r)=>vc($.points,r,!0),15:($,r)=>vc($.points,r),19:($,r)=>hc($.points,r),21:($,r)=>{const e=$.pos,t=Ba([],e,$.size),i=[Re([],e),[t[0],e[1]],t,[e[0],t[1]]];return null!=r?k(new df(i),r):i}}),k.isa(8,15),k.isa(17,13),k.isa(23,13);const Ub=($,r)=>u($)?[$,!1]:[$.theta?Math.floor(ka/$.theta):$.dist?Math.floor(ka/($.dist/r)):$.num||q,!0===$.last];function Sb(...e){return L(jb(Y(()=>[e[0]],(e,$)=>L(ua($),gc(),e))),zc(),kf(e[1])?dd(e[1],e[2]||1):e[1])}const Ra=T(X);Ra.add(S,(t,e)=>Sb(k(t),e));const oe=t=>3==t.length?[[t[0],t[1],t[2]]]:4==t.length?[[t[0],t[1],t[2]],[t[0],t[2],t[3]]]:void 0;class ne extends m{constructor(t,$,e){super(t,e),this.faces=$}get type(){return 14}copy(){return new $lRCv$export$Polygon3(i(this.points),this.faces,Object.assign({},this.attribs))}toHiccup(){return["polygon3",this.attribs,this.points]}}const ke=[[-1,1,0],[-1,-1,0],[1,-1,0],[1,1,0]];class je extends m{constructor(t=ke,$){super(t,$)}get type(){return 18}copy(){return new $lRCv$export$Quad3(i(this.points),Object.assign({},this.attribs))}toHiccup(){return["polygon",this.attribs,this.points]}}const Fb=T(X);Fb.addAll({1:(t,$)=>{const[e,r,o,l,s,i,p,a]=k(t,$);return[[o,l,a,p],[e,r,i,s],[s,i,p,a],[e,l,o,r],[r,o,p,i],[e,s,a,l]]},18:(t,$)=>[t.points]}),k.addAll({1:(t,$)=>{const e=t.pos,r=re([],e,t.size);return[e,[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],e[1],e[2]],[e[0],r[1],e[2]],[e[0],r[1],r[2]],r,[r[0],r[1],e[2]]]},18:(t,$)=>t.points});const da=T(X);da.add(12,(t,$)=>new ne(k(t,$),Fb(t,$),Object.assign({},t.attribs))),da.isa(1,12),da.isa(18,12),Ra.add(14,(t,$)=>[...ua(t=>Sb(t,$),t.faces)]);const yb=T(X);yb.addAll({18:(t,$=[oe])=>{const e=Ra(da(t),$),r=new Bf({num:3*e.length,mem:{size:512},attribs:{position:{type:5126,size:3,byteOffset:0},texcoord:{type:5126,size:2,byteOffset:3*I[Cc[5126]]}}});return r.setAttribValues("position",[...ua(t=>t,e)]),r.setAttribValues("texcoord",[[0,1],[0,0],[1,0],[0,1],[1,0],[1,1]]),r}});var Pd={};Pd="#define GLSLIFY 1\nuniform mat4 matModelView;\nuniform mat4 matProj;\n\nattribute vec3 position;\nattribute vec2 texcoord;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = texcoord;\n\n  gl_Position = matProj * matModelView * vec4(position, 1.0);\n}";var Od={};Od="#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\nuniform vec2 scale;\nuniform float freq;\nuniform float iter;\nuniform float time;\nuniform sampler2D permutation;\nuniform sampler2D grads;\n\nvarying vec2 vUv;\n\nconst float PI = 3.14159265359;\nconst vec3 HARU = vec3(0.14,0.37,0.03);\n\nfloat fade(float t)\n{\n  return t*t*t*(t*(t*6.-15.)+10.);// new curve\n}\nfloat perm(float x)\n{\n  return texture2D(permutation,vec2(x/256.,0)).r*256.;\n}\nfloat grad(float x,vec3 p)\n{\n  return dot(texture2D(grads,vec2(x,0)).rgb,p);\n}\nfloat lerp(float a,float b,float c)\n{\n  return mix(a,b,c);\n}\nfloat snoise(vec3 p)\n{\n  vec3 P=mod(floor(p),256.);\n  p-=floor(p);\n  vec3 f=vec3(fade(p.x),fade(p.y),fade(p.z));\n  float A=perm(P.x)+P.y;\n  float AA=perm(A)+P.z;\n  float AB=perm(A+1.)+P.z;\n  float B=perm(P.x+1.)+P.y;\n  float BA=perm(B)+P.z;\n  float BB=perm(B+1.)+P.z;\n\n  return lerp(\n    lerp(lerp(grad(perm(AA),p),\n    grad(perm(BA),p+vec3(-1.,0.,0.)),f.x),\n    lerp(grad(perm(AB),p+vec3(0.,-1.,0.)),\n    grad(perm(BB),p+vec3(-1.,-1.,0.)),f.x),f.y),\n    lerp(lerp(grad(perm(AA+1.),p+vec3(0.,0.,-1.)),\n    grad(perm(BA+1.),p+vec3(-1.,0.,-1.)),f.x),\n    lerp(grad(perm(AB+1.),p+vec3(0.,-1.,-1.)),\n    grad(perm(BB+1.),p+vec3(-1.,-1.,-1.)),f.x),f.y),\n  f.z);\n}\n\nvec2 disp(vec2 uv,float f){\n  float r=.10;\n  float v=snoise(vec3(uv/scale*100.,time));\n\n  v*=f;\n  return uv+vec2(r*cos(v),r*sin(v));\n}\n\nvoid main(){\n  vec2 uv=vUv;\n\n  float freqStep=freq/iter;\n\n  if(iter>=1.){uv=disp(uv,freqStep);}\n  if(iter>=2.){uv=disp(uv,freqStep);}\n  if(iter>=3.){uv=disp(uv,freqStep);}\n  if(iter>=4.){uv=disp(uv,freqStep);}\n  if(iter>=5.){uv=disp(uv,freqStep);}\n\n  vec3 color=vec3(uv,.8);\n\n  float bri = (color.r + color.g + color.b) / 3.0;\n  // color = vec3(bri + .9) * HARU;\n  color = vec3(bri + 0.1);\n\n  gl_FragColor=vec4(color,1.);\n}";const we=new Uint8Array([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]),ve=new Uint8Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1,1,1,0,0,-1,1,-1,1,0,0,-1,-1]);class se extends he{set params(e){let r=this.mat.uniforms;r.scale=e.scale,r.freq=e.freq,r.iter=e.iter,this.speed=e.speed}init(e){super.init(e);const r=e.canvas.clientWidth,t=e.canvas.clientHeight;this.camera=new bg(r,t);const $=new yg;var $KcNV$$interop$default=aa(Pd);var $ZDta$$interop$default=aa(Od);this.mat=new fg($KcNV$$interop$default.d,$ZDta$$interop$default.d),$.add(new zg(yb(new je),this.mat)),this.cmd=new eg(e,$),this.mat.uniforms.permutation=g.createTexture(e,{src:we,format:e.LUMINANCE,width:256,height:1,wrap:e.REPEAT,minMag:e.LINEAR}),this.mat.uniforms.grads=g.createTexture(e,{src:ve,format:e.RGB,width:16,height:1,wrap:e.REPEAT,minMag:e.LINEAR})}render(e){const r=this.gl;r.disable(r.DEPTH_TEST),r.enable(r.CULL_FACE),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this.mat.uniforms.time=e/1e4*this.speed,this.cmd.draw(this.camera)}}const le=({ui:$,bus:e})=>{const r=new se,p=Jd(r,{init(){e.dispatch([H.BG_ACTIVE,!0])},release(){e.dispatch([H.BG_ACTIVE,!1])}});return()=>[p,$.bg,{scale:[32,32],freq:50,iter:5,speed:1.5}]};class ie{constructor(t){this.config=t,this.state=new M(t.initialState||{}),this.ctx={bus:new cd(this.state,t.events,t.effects),views:{},ui:t.ui},this.addViews(this.config.views),this.router=new Fd(t.router),this.router.addListener(W,t=>this.ctx.bus.dispatch([W,t.value])),this.ctx.bus.addHandlers({[W]:jc("route"),[H.ROUTE_TO]:(t,[e,r])=>({[qa.ROUTE_TO]:r})}),this.ctx.bus.addEffect(qa.ROUTE_TO,([t,e])=>this.router.routeTo(this.router.format(t,e))),this.addViews({route:"route",routeComponent:["route.id",t=>(this.config.components[t]||(()=>["div",`missing component for route: ${t}`]))(this.ctx)]})}addViews(t){const e=this.ctx.views;for(let r in t){const i=t[r];C(i)?e[r]=this.state.addView(i[0],i[1]):e[r]=this.state.addView(i)}}start(){this.router.start();const t=this.rootComponent();jf(({views:{bgActive:e}})=>{if(this.ctx.bus.processQueue()||e.deref())return t},{root:this.config.domRoot,ctx:this.ctx})}rootComponent(){const t=this.ctx.ui,e=le(this.ctx);return["div",t.root,e,this.ctx.views.routeComponent]}}function Id({ui:$}){return["div",$.title,"pngupngu"]}const Ca={id:"home",match:["home"]};const _c={router:{useFragment:!0,defaultRouteID:Ca.id,routes:[Ca]},events:{[H.BG_ACTIVE]:jc("bgActive")},effects:{},components:{[Ca.id]:Id},domRoot:"app",initialState:{bgActive:!1},views:{bgActive:"bgActive"},ui:{title:{class:"red center-child absolute"},root:{class:"w-100 h-100 pa0 sans-serif f6 fw2 barlow bg-white98 relative"},bg:{class:""}}};new ie(_c).start();return{"9B6d":{}};});